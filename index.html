<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#1e1b4b">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>ì •ì±…ìê¸ˆ ë¶„ì„ ì±—ë´‡</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
  
  <!-- ì†ŒìŠ¤ì½”ë“œ ë³´í˜¸ -->
  <script>
  (function(){
    // ìš°í´ë¦­ ë°©ì§€
    document.addEventListener('contextmenu', function(e) {
      e.preventDefault();
      return false;
    });
    
    // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ë°©ì§€
    document.addEventListener('keydown', function(e) {
      // F12 ë°©ì§€
      if (e.key === 'F12' || e.keyCode === 123) {
        e.preventDefault();
        return false;
      }
      // Ctrl+Shift+I (ê°œë°œìë„êµ¬)
      if (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'i' || e.keyCode === 73)) {
        e.preventDefault();
        return false;
      }
      // Ctrl+Shift+J (ì½˜ì†”)
      if (e.ctrlKey && e.shiftKey && (e.key === 'J' || e.key === 'j' || e.keyCode === 74)) {
        e.preventDefault();
        return false;
      }
      // Ctrl+Shift+C (ìš”ì†Œê²€ì‚¬)
      if (e.ctrlKey && e.shiftKey && (e.key === 'C' || e.key === 'c' || e.keyCode === 67)) {
        e.preventDefault();
        return false;
      }
      // Ctrl+U (ì†ŒìŠ¤ë³´ê¸°)
      if (e.ctrlKey && (e.key === 'U' || e.key === 'u' || e.keyCode === 85)) {
        e.preventDefault();
        return false;
      }
      // Ctrl+S (ì €ì¥)
      if (e.ctrlKey && (e.key === 'S' || e.key === 's' || e.keyCode === 83)) {
        e.preventDefault();
        return false;
      }
    });
    
    // ë“œë˜ê·¸ ë°©ì§€
    document.addEventListener('dragstart', function(e) {
      e.preventDefault();
      return false;
    });
    
    // ì„ íƒ ë°©ì§€ (ì…ë ¥ í•„ë“œ ì œì™¸)
    document.addEventListener('selectstart', function(e) {
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
        return true;
      }
      e.preventDefault();
      return false;
    });
  })();
  </script>
  
  <style>
    /* iframe ë° ëª¨ë°”ì¼ ìµœì í™” */
    :root {
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
    }
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    html { 
      height: 100%;
      height: -webkit-fill-available; 
    }
    body {
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(180deg, #f8fafc 0%, #e2e8f0 100%);
      min-height: 100%;
      min-height: 100vh;
      min-height: -webkit-fill-available;
      -webkit-font-smoothing: antialiased;
      touch-action: manipulation;
      /* ì„ íƒ ë°©ì§€ */
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    /* ì…ë ¥ í•„ë“œëŠ” ì„ íƒ í—ˆìš© */
    input, textarea {
      -webkit-user-select: text;
      -moz-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }
    .chatbot-container {
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      height: 100vh;
      height: 100dvh;
      max-width: 100%;
      margin: 0;
      padding: 0;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }

    /* í—¤ë” */
    .chat-header {
      background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #4338ca 100%);
      padding: 16px 20px;
      color: white;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      position: relative;
      overflow: hidden;
      flex-shrink: 0;
    }
    .chat-header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -20%;
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      border-radius: 50%;
    }
    .header-content {
      display: flex;
      align-items: center;
      gap: 14px;
      position: relative;
      z-index: 1;
    }
    .header-avatar {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
    }
    .header-info h1 { font-size: 18px; font-weight: 700; letter-spacing: -0.3px; }
    .header-status {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      opacity: 0.85;
      margin-top: 2px;
    }
    .status-dot {
      width: 8px;
      height: 8px;
      background: #4ade80;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(0.9); }
    }
    .header-progress {
      display: none;
      align-items: center;
      gap: 10px;
      margin-top: 14px;
      position: relative;
      z-index: 1;
    }
    .header-progress.active { display: flex; }
    .progress-bar {
      flex: 1;
      height: 6px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #fbbf24 0%, #f59e0b 100%);
      border-radius: 10px;
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      width: 0%;
    }
    .progress-text { font-size: 12px; font-weight: 600; min-width: 36px; }

    /* ë©”ì‹œì§€ ì˜ì—­ */
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .chat-messages::-webkit-scrollbar { width: 6px; }
    .chat-messages::-webkit-scrollbar-track { background: transparent; }
    .chat-messages::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    .message-wrapper {
      display: flex;
      gap: 10px;
      animation: messageIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .message-wrapper.user { flex-direction: row-reverse; }
    @keyframes messageIn {
      from { opacity: 0; transform: translateY(16px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .bot-avatar {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      flex-shrink: 0;
      box-shadow: 0 2px 8px rgba(99, 102, 241, 0.15);
    }
    .message-content {
      max-width: 85%;
      display: flex;
      flex-direction: column;
    }
    .message-wrapper.user .message-content { align-items: flex-end; }
    .section-badge {
      font-size: 11px;
      font-weight: 600;
      color: #6366f1;
      background: linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%);
      padding: 4px 12px;
      border-radius: 20px;
      margin-bottom: 8px;
      display: inline-block;
    }
    .message-bubble { padding: 14px 18px; border-radius: 24px; position: relative; }
    .message-bubble.bot {
      background: white;
      border-radius: 24px 24px 24px 6px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
    }
    .message-bubble.user {
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: white;
      border-radius: 24px 24px 6px 24px;
      box-shadow: 0 4px 14px rgba(99, 102, 241, 0.35);
    }
    .message-icon { font-size: 28px; margin-bottom: 8px; }
    .message-text { font-size: 15px; line-height: 1.6; white-space: pre-line; }
    .message-bubble.bot .message-text { color: #1e293b; }
    .message-time { font-size: 11px; color: #94a3b8; margin-top: 6px; }

    /* íƒ€ì´í•‘ ì• ë‹ˆë©”ì´ì…˜ */
    .typing-dots { display: flex; gap: 5px; padding: 4px 0; }
    .typing-dots span {
      width: 8px;
      height: 8px;
      background: #94a3b8;
      border-radius: 50%;
      animation: bounce 1.4s infinite ease-in-out both;
    }
    .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
    .typing-dots span:nth-child(2) { animation-delay: -0.16s; }
    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
      40% { transform: scale(1.1); opacity: 1; }
    }

    /* ë²„íŠ¼ë“¤ */
    .start-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      margin-top: 16px;
      padding: 14px 24px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: white;
      border: none;
      border-radius: 16px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 14px rgba(99, 102, 241, 0.4);
      font-family: inherit;
    }
    .start-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(99, 102, 241, 0.5); }
    .start-btn:active { transform: translateY(0); }
    .choice-buttons { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 14px; }
    .choice-btn {
      padding: 10px 18px;
      background: #f1f5f9;
      border: 2px solid transparent;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 500;
      color: #475569;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      font-family: inherit;
    }
    .choice-btn:hover {
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
    }
    .choice-btn:active { transform: translateY(0); }

    /* ì…ë ¥ ì˜ì—­ */
    .chat-input {
      display: none;
      background: white;
      padding: 16px 20px;
      border-top: 1px solid #e2e8f0;
      box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.05);
      flex-shrink: 0;
    }
    .chat-input.active { display: block; }
    .input-wrapper { display: flex; gap: 12px; max-width: 600px; margin: 0 auto; }
    .input-wrapper input {
      flex: 1;
      padding: 14px 20px;
      border: 2px solid #e2e8f0;
      border-radius: 24px;
      font-size: 15px;
      transition: all 0.25s;
      background: #f8fafc;
      font-family: inherit;
    }
    .input-wrapper input:focus {
      outline: none;
      border-color: #6366f1;
      background: white;
      box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
    }
    .send-btn {
      min-width: 70px;
      height: 50px;
      padding: 0 16px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      border: none;
      border-radius: 25px;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: all 0.25s;
      box-shadow: 0 4px 14px rgba(99, 102, 241, 0.4);
      flex-shrink: 0;
      font-size: 15px;
      font-weight: 600;
      font-family: inherit;
    }
    .send-btn .send-text { display: inline; }
    .send-btn:disabled { opacity: 0.4; cursor: not-allowed; box-shadow: none; }
    .send-btn:not(:disabled):hover { transform: scale(1.05); box-shadow: 0 6px 20px rgba(99, 102, 241, 0.5); }
    .send-btn:not(:disabled):active { transform: scale(0.98); }

    /* ê²°ê³¼ ì¹´ë“œ */
    .result-card {
      background: white;
      border-radius: 28px;
      padding: 28px;
      margin: 8px 0;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
      animation: resultIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }
    @keyframes resultIn {
      from { opacity: 0; transform: scale(0.95) translateY(20px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }
    .result-header { text-align: center; margin-bottom: 28px; }
    .result-badge {
      display: inline-block;
      padding: 6px 16px;
      background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
      color: white;
      font-size: 12px;
      font-weight: 600;
      border-radius: 20px;
      margin-bottom: 14px;
    }
    .result-header h2 { font-size: 22px; font-weight: 700; color: #1e293b; margin-bottom: 4px; }
    .result-header p { font-size: 14px; color: #64748b; }

    .result-unavailable { text-align: center; padding: 40px 20px; }
    .unavailable-icon { font-size: 56px; margin-bottom: 16px; }
    .result-unavailable h3 { font-size: 20px; color: #ef4444; margin-bottom: 8px; }
    .result-unavailable p { color: #64748b; font-size: 14px; }

    .result-gauge { display: flex; flex-direction: column; align-items: center; margin-bottom: 28px; position: relative; }
    .result-gauge svg { width: 140px; height: 140px; transform: rotate(-90deg); }
    .gauge-bg { fill: none; stroke: #e2e8f0; stroke-width: 10; }
    .gauge-fill {
      fill: none;
      stroke: url(#gaugeGradient);
      stroke-width: 10;
      stroke-linecap: round;
      transition: stroke-dasharray 1s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .gauge-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -60%);
      display: flex;
      align-items: baseline;
    }
    .gauge-value { font-size: 42px; font-weight: 800; color: #1e293b; }
    .gauge-unit { font-size: 20px; font-weight: 600; color: #64748b; margin-left: 2px; }
    .gauge-label { font-size: 14px; font-weight: 600; color: #6366f1; margin-top: 8px; }

    .result-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-bottom: 24px; }
    .stat-card {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      padding: 20px;
      border-radius: 20px;
      text-align: center;
    }
    .stat-icon { font-size: 28px; margin-bottom: 8px; }
    .stat-label { font-size: 12px; color: #64748b; margin-bottom: 4px; }
    .stat-value { font-size: 20px; font-weight: 700; color: #1e293b; }

    /* ì¶”ì²œ ìƒí’ˆ ì„¹ì…˜ */
    .recommend-section {
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .recommend-section h4 {
      font-size: 15px;
      font-weight: 700;
      color: #92400e;
      margin-bottom: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .recommend-list { display: flex; flex-direction: column; gap: 14px; }
    .recommend-item {
      background: white;
      border-radius: 16px;
      padding: 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      overflow: hidden;
      border: 1px solid #e2e8f0;
    }
    .recommend-item-header {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border-bottom: 1px solid #e2e8f0;
    }
    .recommend-item-number {
      width: 28px;
      height: 28px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: white;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 14px;
      flex-shrink: 0;
    }
    .recommend-item-title-wrap { flex: 1; }
    .recommend-item-title {
      font-size: 15px;
      font-weight: 700;
      color: #1e293b;
      margin-bottom: 2px;
    }
    .recommend-item-org {
      font-size: 11px;
      padding: 2px 8px;
      background: #64748b;
      color: white;
      border-radius: 4px;
      font-weight: 600;
      display: inline-block;
    }
    .recommend-item-body { padding: 14px 16px; }
    .recommend-info-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px dashed #e2e8f0;
    }
    .recommend-info-row:last-of-type { border-bottom: none; }
    .recommend-info-label { font-size: 13px; color: #64748b; font-weight: 500; }
    .recommend-info-value { font-size: 14px; font-weight: 600; color: #1e293b; text-align: right; }
    .recommend-info-value.highlight { color: #6366f1; font-weight: 700; }
    .recommend-estimate {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 12px;
      padding: 12px 14px;
      background: linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%);
      border-radius: 10px;
      font-size: 13px;
      color: #4338ca;
    }
    .recommend-estimate-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .recommend-estimate strong { font-weight: 700; }
    
    /* ê¸°ì—… ë¶„ë¥˜ ë°°ì§€ */
    .biz-category-badge {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 20px;
      border-radius: 12px;
      margin-bottom: 16px;
      color: white;
      flex-wrap: wrap;
    }
    .biz-category-icon { font-size: 20px; }
    .biz-category-text { font-weight: 700; font-size: 16px; }
    .biz-category-sub { font-size: 12px; opacity: 0.9; }

    /* ì¸ì‚¬ì´íŠ¸ */
    .result-insights {
      background: linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%);
      padding: 20px;
      border-radius: 20px;
      margin-bottom: 20px;
    }
    .result-insights h4 { font-size: 15px; font-weight: 600; color: #4338ca; margin-bottom: 14px; }
    .insight-list { display: flex; flex-direction: column; gap: 10px; }
    .insight-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 14px;
      background: white;
      border-radius: 12px;
      font-size: 14px;
      color: #475569;
    }
    .insight-item.positive { background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); color: #047857; }
    .insight-item.warning { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); color: #92400e; }
    .insight-icon { font-size: 16px; }

    /* ìƒí™˜ ê³„ì‚°ê¸° */
    .calculator-section {
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 20px;
      margin-bottom: 20px;
      overflow: hidden;
    }
    .calculator-header {
      padding: 16px 20px;
      background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
      color: white;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      font-size: 15px;
    }
    .calculator-header:hover { opacity: 0.95; }
    .calculator-arrow {
      transition: transform 0.3s;
      font-size: 12px;
    }
    .calculator-arrow.open { transform: rotate(180deg); }
    .calculator-body {
      display: none;
      padding: 20px;
      animation: slideDown 0.3s ease;
    }
    .calculator-body.open { display: block; }
    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .calc-row { margin-bottom: 16px; }
    .calc-label {
      font-size: 13px;
      font-weight: 600;
      color: #475569;
      margin-bottom: 6px;
      display: block;
    }
    .calc-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 14px;
      font-family: inherit;
      transition: all 0.2s;
    }
    .calc-input:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }
    .calc-select {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 14px;
      font-family: inherit;
      background: white;
      cursor: pointer;
    }
    .calc-row-inline {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .calc-btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      font-family: inherit;
      transition: all 0.2s;
      margin-top: 8px;
    }
    .calc-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); }
    .calc-result {
      margin-top: 20px;
      padding: 20px;
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border-radius: 16px;
      display: none;
    }
    .calc-result.show { display: block; animation: fadeIn 0.3s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .calc-result-summary {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 16px;
    }
    .calc-summary-item { text-align: center; }
    .calc-summary-label { font-size: 12px; color: #64748b; margin-bottom: 4px; }
    .calc-summary-value { font-size: 18px; font-weight: 700; color: #1e293b; }
    .calc-summary-value.primary { color: #6366f1; }
    .schedule-table-wrapper {
      max-height: 300px;
      overflow-y: auto;
      border-radius: 12px;
      border: 1px solid #e2e8f0;
    }
    .schedule-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }
    .schedule-table th {
      background: #1e1b4b;
      color: white;
      padding: 10px 8px;
      font-weight: 600;
      position: sticky;
      top: 0;
    }
    .schedule-table td {
      padding: 10px 8px;
      text-align: center;
      border-bottom: 1px solid #e2e8f0;
    }
    .schedule-table tr:nth-child(even) { background: #f8fafc; }
    .schedule-table tr:hover { background: #eef2ff; }

    /* ìƒì„¸ì •ë³´ */
    .result-details { margin-bottom: 16px; }
    .result-details summary {
      padding: 14px 18px;
      background: #f8fafc;
      border-radius: 14px;
      font-size: 14px;
      font-weight: 600;
      color: #475569;
      cursor: pointer;
      list-style: none;
    }
    .result-details summary::-webkit-details-marker { display: none; }
    .details-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      padding: 16px;
      margin-top: 10px;
      background: #f8fafc;
      border-radius: 14px;
    }
    .details-grid > div { display: flex; flex-direction: column; gap: 2px; }
    .details-grid span { font-size: 11px; color: #94a3b8; }
    .details-grid strong { font-size: 13px; color: #1e293b; }

    .result-notice {
      font-size: 12px;
      color: #94a3b8;
      text-align: center;
      margin-bottom: 20px;
      line-height: 1.5;
      padding: 16px;
      background: #fffbeb;
      border: 1px solid #fde68a;
      border-radius: 12px;
    }

    .restart-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
      color: white;
      border: none;
      border-radius: 18px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 16px rgba(30, 27, 75, 0.3);
      font-family: inherit;
    }
    .restart-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(30, 27, 75, 0.4); }
    .restart-btn:active { transform: translateY(0); }

    /* í†µê³„ ë°°ë„ˆ */
    .stats-banner {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 20px;
      color: white;
    }
    .stats-banner-title {
      font-size: 12px;
      opacity: 0.7;
      margin-bottom: 10px;
    }
    .stats-banner-items { display: flex; justify-content: space-around; }
    .stats-banner-item { text-align: center; }
    .stats-banner-value { font-size: 20px; font-weight: 800; color: #fbbf24; }
    .stats-banner-label { font-size: 11px; opacity: 0.7; margin-top: 2px; }

    /* ë°˜ì‘í˜• */
    /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
    @media (max-width: 480px) {
      .message-wrapper { gap: 8px; }
      .bot-avatar { width: 32px; height: 32px; font-size: 16px; border-radius: 10px; }
      .message-content { max-width: 100%; }
      .message-bubble { padding: 12px 14px; font-size: 15px; border-radius: 18px; }
      .result-card { padding: 16px 10px; margin: 0; border-radius: 18px; }
      .gauge-value { font-size: 36px; }
      .stat-value { font-size: 17px; }
      .stat-card { padding: 14px 8px; border-radius: 12px; }
      .chat-header { padding: 12px 10px; }
      .header-avatar { width: 38px; height: 38px; font-size: 18px; border-radius: 12px; }
      .header-info h1 { font-size: 15px; }
      .header-info p { font-size: 11px; }
      .chat-messages { padding: 8px 6px; gap: 12px; -webkit-overflow-scrolling: touch; }
      .chat-input { padding: 8px 6px; padding-bottom: calc(8px + var(--safe-bottom)); }
      .input-wrapper { max-width: 100%; gap: 8px; }
      .input-wrapper input { font-size: 16px !important; padding: 14px 16px; border-radius: 22px; flex: 1; min-width: 0; }
      .send-btn { min-width: 64px; height: 48px; padding: 0 14px; font-size: 15px; border-radius: 24px; }
      .choice-btn { padding: 10px 14px; font-size: 14px; min-height: 44px; border-radius: 16px; }
      .choice-buttons { gap: 6px; }
      .start-btn { padding: 14px 18px; font-size: 15px; min-height: 48px; border-radius: 14px; }
      .section-badge { font-size: 10px; padding: 3px 10px; }
      .recommend-section { padding: 0; }
      .recommend-estimate { gap: 6px; padding: 8px; border-radius: 10px; }
      .recommend-estimate-row { flex-direction: column; gap: 3px; align-items: flex-start; font-size: 11px; }
      .recommend-item { margin-bottom: 8px; border-radius: 14px; }
      .recommend-item-header { padding: 10px; }
      .recommend-item-number { width: 24px; height: 24px; font-size: 12px; }
      .recommend-item-title { font-size: 14px; }
      .recommend-item-org { font-size: 10px; }
      .recommend-item-body { padding: 10px; }
      .recommend-info-label { font-size: 11px; }
      .recommend-info-value { font-size: 12px; }
      .cta-main-btn { font-size: 15px; padding: 14px 12px; min-height: 50px; border-radius: 14px; }
      .cta-item-btn { padding: 10px 12px; min-height: 42px; font-size: 13px; border-radius: 8px; }
      .calc-input, .calc-select { font-size: 16px !important; padding: 10px 12px; }
      .calc-row-inline { grid-template-columns: 1fr; }
      .biz-category-badge { padding: 8px 12px; font-size: 13px; border-radius: 8px; }
      .biz-category-sub { font-size: 10px; }
      .stats-banner { padding: 10px; border-radius: 12px; }
      .stats-banner-value { font-size: 16px; }
      .stats-banner-label { font-size: 9px; }
      .result-stats { gap: 6px; }
      .result-header { margin-bottom: 20px; }
      .result-header h2 { font-size: 18px; }
      .result-badge { font-size: 10px; padding: 5px 12px; }
      .gauge-label { font-size: 13px; }
      .insight-list { gap: 4px; }
      .insight-item { padding: 6px 8px; font-size: 12px; border-radius: 8px; }
      .insight-icon { font-size: 14px; }
      .result-details summary { padding: 10px 12px; font-size: 12px; }
      .details-grid { padding: 10px; font-size: 12px; }
      .result-notice { font-size: 10px; padding: 10px; }
      .restart-btn { padding: 14px 20px; font-size: 14px; }
    }
    
    /* ì•„ì£¼ ì‘ì€ í™”ë©´ */
    @media (max-width: 360px) {
      .chat-messages { padding: 6px 4px; gap: 10px; }
      .chat-input { padding: 6px 4px; }
      .message-wrapper { gap: 6px; }
      .bot-avatar { width: 28px; height: 28px; font-size: 14px; }
      .message-bubble { padding: 10px 12px; font-size: 14px; }
      .result-card { padding: 14px 8px; }
      .gauge-value { font-size: 32px; }
      .stat-value { font-size: 15px; }
      .cta-main-btn { font-size: 14px; padding: 12px 10px; }
      .header-info h1 { font-size: 14px; }
      .input-wrapper input { padding: 12px 14px; }
      .send-btn { min-width: 58px; height: 44px; padding: 0 12px; font-size: 14px; }
    }

    .svg-defs { position: absolute; width: 0; height: 0; overflow: hidden; }

    /* ============ ë¶„ì„í•˜ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ ============ */
    .analysis-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      width: 100%;
      padding: 18px 20px;
      margin-top: 16px;
      background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
      color: white;
      font-size: 16px;
      font-weight: 700;
      border: none;
      border-radius: 16px;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4);
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
      font-family: inherit;
      -webkit-tap-highlight-color: transparent;
    }
    .analysis-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(120deg, transparent, rgba(255,255,255,0.3), transparent);
      animation: analysis-shine 2s infinite;
    }
    @keyframes analysis-shine {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    .analysis-btn:active {
      transform: scale(0.98);
      box-shadow: 0 4px 16px rgba(16, 185, 129, 0.35);
    }
    @media (max-width: 480px) {
      .analysis-btn { font-size: 15px; padding: 16px 16px; }
    }

    /* ============ CTA ë²„íŠ¼ ìŠ¤íƒ€ì¼ ============ */
    .cta-main-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      width: 100%;
      padding: 18px 24px;
      margin: 16px 0;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
      color: white;
      font-size: 18px;
      font-weight: 700;
      border: none;
      border-radius: 16px;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .cta-main-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(120deg, transparent, rgba(255,255,255,0.3), transparent);
      animation: cta-shine 2s infinite;
    }
    @keyframes cta-shine {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    .cta-main-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(99, 102, 241, 0.5);
    }
    .cta-main-btn:active {
      transform: translateY(0);
    }

    .cta-item-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 10px 16px;
      margin-top: 0;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: white;
      font-size: 14px;
      font-weight: 600;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      width: 100%;
      transition: all 0.25s ease;
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
    }
    .cta-item-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 16px rgba(99, 102, 241, 0.4);
    }

    /* ============ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ ============ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      height: 100dvh;
      display: none;
      justify-content: center;
      align-items: flex-end;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      z-index: 9999;
      padding: 0;
    }
    .modal-overlay.show {
      display: flex;
    }
    .modal-content {
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 24px 24px 0 0;
      padding: 28px 24px;
      padding-bottom: calc(28px + var(--safe-bottom));
      position: relative;
      animation: modalSlideUp 0.3s ease;
      max-height: 90vh;
      max-height: 90dvh;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    .modal-content::before {
      content: '';
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 4px;
      background: #d1d5db;
      border-radius: 2px;
    }
    @keyframes modalSlideUp {
      from { opacity: 0; transform: translateY(100%); }
      to { opacity: 1; transform: translateY(0); }
    }
    @media (min-width: 600px) {
      .modal-overlay { align-items: center; padding: 20px; }
      .modal-content { border-radius: 24px; animation: modalIn 0.3s ease; }
      .modal-content::before { display: none; }
      @keyframes modalIn {
        from { opacity: 0; transform: scale(0.95); }
        to { opacity: 1; transform: scale(1); }
      }
    }
    .modal-close {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 36px;
      height: 36px;
      background: #f1f5f9;
      border: none;
      border-radius: 50%;
      font-size: 22px;
      color: #64748b;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    .modal-close:hover {
      background: #e2e8f0;
      color: #334155;
    }
    .modal-header {
      text-align: center;
      margin-bottom: 24px;
    }
    .modal-header h3 {
      font-size: 22px;
      font-weight: 700;
      color: #1e1b4b;
      margin-bottom: 8px;
    }
    .modal-header p {
      font-size: 14px;
      color: #64748b;
    }
    .modal-product-info {
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
      border-radius: 12px;
      padding: 14px;
      margin-bottom: 20px;
      border: 1px solid #bae6fd;
    }
    .modal-product-name {
      font-size: 16px;
      font-weight: 700;
      color: #0369a1;
      margin-bottom: 4px;
    }
    .modal-product-detail {
      font-size: 13px;
      color: #0284c7;
    }
    .form-group {
      margin-bottom: 18px;
    }
    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: #374151;
      margin-bottom: 8px;
    }
    .form-label .required {
      color: #ef4444;
      margin-left: 2px;
    }
    .form-input {
      width: 100%;
      padding: 14px 16px;
      font-size: 16px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      outline: none;
      transition: all 0.2s;
    }
    .form-input:focus {
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }
    .form-input::placeholder {
      color: #9ca3af;
    }
    .phone-input-group {
      display: flex;
      gap: 8px;
    }
    .phone-input-group select {
      flex: 0 0 90px;
      padding: 14px 12px;
      font-size: 16px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      outline: none;
      background: white;
      cursor: pointer;
    }
    .phone-input-group select:focus {
      border-color: #6366f1;
    }
    .phone-input-group input {
      flex: 1;
      text-align: center;
    }
    .agreement-box {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 14px;
      background: #f8fafc;
      border-radius: 12px;
      margin-bottom: 20px;
    }
    .agreement-box input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-top: 2px;
      cursor: pointer;
      accent-color: #6366f1;
    }
    .agreement-box label {
      font-size: 14px;
      color: #374151;
      cursor: pointer;
      line-height: 1.5;
    }
    .agreement-box .privacy-link {
      color: #6366f1;
      text-decoration: underline;
      cursor: pointer;
      font-weight: 600;
    }
    .submit-btn {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: white;
      font-size: 17px;
      font-weight: 700;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 6px 20px rgba(99, 102, 241, 0.35);
    }
    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(99, 102, 241, 0.45);
    }
    .submit-btn:disabled {
      background: #cbd5e1;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    .analysis-submit-btn {
      background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
      box-shadow: 0 6px 20px rgba(16, 185, 129, 0.35);
    }
    .analysis-submit-btn:active {
      transform: scale(0.98);
    }

    /* ê°œì¸ì •ë³´ì·¨ê¸‰ë°©ì¹¨ ëª¨ë‹¬ */
    .privacy-modal-content {
      max-height: 80vh;
      overflow-y: auto;
    }
    .privacy-modal-content h4 {
      font-size: 18px;
      color: #1e1b4b;
      margin: 20px 0 12px 0;
    }
    .privacy-modal-content h4:first-child {
      margin-top: 0;
    }
    .privacy-modal-content p {
      font-size: 14px;
      color: #4b5563;
      line-height: 1.7;
      margin-bottom: 12px;
    }
    .privacy-modal-content ul {
      margin: 8px 0 16px 20px;
      font-size: 14px;
      color: #4b5563;
      line-height: 1.7;
    }

    /* ì„±ê³µ ëª¨ë‹¬ */
    .success-icon {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      font-size: 40px;
      box-shadow: 0 8px 24px rgba(16, 185, 129, 0.3);
    }
    .success-title {
      font-size: 22px;
      font-weight: 700;
      color: #1e1b4b;
      text-align: center;
      margin-bottom: 12px;
    }
    .success-message {
      font-size: 15px;
      color: #64748b;
      text-align: center;
      line-height: 1.6;
      margin-bottom: 24px;
    }
    .success-btn {
      width: 100%;
      padding: 16px;
      background: #10b981;
      color: white;
      font-size: 16px;
      font-weight: 600;
      border: none;
      border-radius: 12px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <svg class="svg-defs">
    <defs>
      <linearGradient id="gaugeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#6366f1" />
        <stop offset="100%" stop-color="#8b5cf6" />
      </linearGradient>
    </defs>
  </svg>

  <div class="chatbot-container">
    <header class="chat-header">
      <div class="header-content">
        <div class="header-avatar">ğŸ’¼</div>
        <div class="header-info">
          <h1>ì •ì±…ìê¸ˆ ë¶„ì„</h1>
          <span class="header-status">
            <span class="status-dot"></span>
            ì‘ë‹µ ê°€ëŠ¥
          </span>
        </div>
      </div>
      <div class="header-progress" id="headerProgress">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <span class="progress-text" id="progressText">0%</span>
      </div>
    </header>

    <main class="chat-messages" id="chatMessages"></main>

    <footer class="chat-input" id="chatInput">
      <div class="input-wrapper">
        <input type="text" id="userInput" placeholder="ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”" autocomplete="off">
        <button class="send-btn" id="sendBtn" disabled>
          <span class="send-text">ì „ì†¡</span>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" />
          </svg>
        </button>
      </div>
    </footer>
  </div>

  <!-- ë¶„ì„/ì¡°íšŒ ì‹ ì²­ ëª¨ë‹¬ -->
  <div id="analysisModal" class="modal-overlay">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('analysisModal')">&times;</button>
      <div class="modal-header">
        <h3>ğŸ“Š ì •ì±…ìê¸ˆ ë¶„ì„/ì¡°íšŒ ì„œë¹„ìŠ¤</h3>
        <p>ë§ì¶¤ ë¶„ì„ ê²°ê³¼ë¥¼ ìƒë‹´ì‚¬ê°€ ì§ì ‘ ì•ˆë‚´í•´ë“œë¦½ë‹ˆë‹¤</p>
      </div>
      <form id="analysisForm" onsubmit="submitAnalysisForm(event)">
        <div class="form-group">
          <label class="form-label">ì„±í•¨(ì´ë¦„)<span class="required">*</span></label>
          <input type="text" id="analysisName" class="form-input" placeholder="ëŒ€í‘œì ì„±í•¨" required>
        </div>
        <div class="form-group">
          <label class="form-label">ì—°ë½ì²˜<span class="required">*</span></label>
          <div class="phone-input-group">
            <select id="analysisPhone1">
              <option value="010">010</option>
              <option value="011">011</option>
            </select>
            <input type="text" id="analysisPhone2" class="form-input" maxlength="4" inputmode="numeric" placeholder="0000" required>
            <input type="text" id="analysisPhone3" class="form-input" maxlength="4" inputmode="numeric" placeholder="0000" required>
          </div>
        </div>
        <div class="agreement-box">
          <input type="checkbox" id="analysisAgreePrivacy" required>
          <label for="analysisAgreePrivacy">
            <span class="privacy-link" onclick="openModal('privacyModal'); event.stopPropagation();">ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš© ë™ì˜ [ë³´ê¸°]</span> <span style="color:#ef4444;">*</span>
          </label>
        </div>
        <button type="submit" class="submit-btn analysis-submit-btn" id="analysisSubmitBtn">
          âœ… ìê¸ˆë¶„ì„ê²°ê³¼ Â· ë¬´ë£Œìë¬¸ìƒë‹´ ë°›ê¸°
        </button>
      </form>
    </div>
  </div>

  <!-- ìƒë‹´ ì‹ ì²­ ëª¨ë‹¬ -->
  <div id="consultModal" class="modal-overlay">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('consultModal')">&times;</button>
      <div class="modal-header">
        <h3>ğŸ“ ë¬´ë£Œìë¬¸ìƒë‹´ ì‹ ì²­</h3>
        <p>ì „ë¬¸ ìƒë‹´ì‚¬ê°€ ë¹ ë¥´ê²Œ ì—°ë½ë“œë¦½ë‹ˆë‹¤</p>
      </div>
      <div id="modalProductInfo" class="modal-product-info" style="display:none;">
        <div class="modal-product-name" id="modalProductName"></div>
        <div class="modal-product-detail" id="modalProductDetail"></div>
      </div>
      <form id="consultForm" onsubmit="submitConsultForm(event)">
        <div class="form-group">
          <label class="form-label">ì„±í•¨(ì´ë¦„)<span class="required">*</span></label>
          <input type="text" id="clientName" class="form-input" placeholder="ëŒ€í‘œì ì„±í•¨" required>
        </div>
        <div class="form-group">
          <label class="form-label">ì—°ë½ì²˜<span class="required">*</span></label>
          <div class="phone-input-group">
            <select id="phone1">
              <option value="010">010</option>
              <option value="011">011</option>
            </select>
            <input type="text" id="phone2" class="form-input" maxlength="4" inputmode="numeric" placeholder="0000" required>
            <input type="text" id="phone3" class="form-input" maxlength="4" inputmode="numeric" placeholder="0000" required>
          </div>
        </div>
        <div class="agreement-box">
          <input type="checkbox" id="agreePrivacy" required>
          <label for="agreePrivacy">
            <span class="privacy-link" onclick="openModal('privacyModal'); event.stopPropagation();">[ê°œì¸ì •ë³´ì·¨ê¸‰ë°©ì¹¨]</span>ì— ë™ì˜í•©ë‹ˆë‹¤ <span style="color:#ef4444;">*</span>
          </label>
        </div>
        <button type="submit" class="submit-btn" id="submitBtn">ì •ì±…ìê¸ˆ ìƒë‹´ ì‹ ì²­í•˜ê¸°</button>
      </form>
    </div>
  </div>

  <!-- ê°œì¸ì •ë³´ì·¨ê¸‰ë°©ì¹¨ ëª¨ë‹¬ -->
  <div id="privacyModal" class="modal-overlay">
    <div class="modal-content privacy-modal-content">
      <button class="modal-close" onclick="closeModal('privacyModal')">&times;</button>
      <h3 style="font-size:20px;font-weight:700;margin-bottom:20px;color:#1e1b4b;">ê°œì¸ì •ë³´ì·¨ê¸‰ë°©ì¹¨</h3>
      <h4>ê°€. ìˆ˜ì§‘í•˜ëŠ” ê°œì¸ì •ë³´ í•­ëª© ë° ìˆ˜ì§‘ë°©ë²•</h4>
      <p>â€“ ì„±ëª…, ì—°ë½ì²˜(íœ´ëŒ€ì „í™” ë²ˆí˜¸), ì‚¬ì—…ìëª…, ì—…ì¢…, ì—°ë§¤ì¶œì•¡ ê·œëª¨</p>
      
      <h4>ë‚˜. ê°œì¸ì •ë³´ì˜ ìˆ˜ì§‘ ë° ì´ìš©ëª©ì </h4>
      <ul>
        <li>ë‹´ë‹¹ìë“¤ì˜ ì „í™” ë° ë¬¸ì ìƒë‹´Â·ì•ˆë‚´</li>
        <li>ì¶”í›„ ë¬¸ì(SMS)ë¥¼ í†µí•œ ì •ì±…ìê¸ˆ ì •ë³´ ìˆ˜ì‹ </li>
        <li>ì •ì±…ìê¸ˆì—°êµ¬ì†Œ ë°”ë¦„ í™ë³´/ê´‘ê³ ë‚´ìš© ìˆ˜ì‹ </li>
      </ul>
      
      <h4>ë‹¤. ë³´ìœ  ë° ì´ìš©ê¸°ê°„</h4>
      <p>ìƒë‹´ ì™„ë£Œ í›„ ê´€ê³„ ë²•ë ¹ì´ ì •í•œ ê¸°ê°„ ë˜ëŠ” ë³¸ì¸ ìš”ì²­ ì‹œê¹Œì§€ ë³´ìœ Â·ì´ìš©</p>
      <ul>
        <li>ì „ììƒê±°ë˜ë²•: ê³„ì•½Â·ê²°ì œÂ·ë¶„ìŸ ê¸°ë¡ 5ë…„</li>
        <li>ì„¸ë²•: ì¥ë¶€ ë° ì¦ë¹™ 5ë…„</li>
        <li>í†µì‹ ë¹„ë°€ë³´í˜¸ë²•: ì ‘ì† ë¡œê·¸ 3ê°œì›”</li>
      </ul>
      
      <h4>ë¼. ë™ì˜ ê±°ë¶€ ì‹œ ì•ˆë‚´</h4>
      <p>í•„ìˆ˜ ì •ë³´ ë™ì˜ ê±°ë¶€ ì‹œ ìƒë‹´ ë° ì •ë³´ ì œê³µì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      
      <h4>ë¬¸ì˜</h4>
      <p>
        ì •ì±…ìê¸ˆì—°êµ¬ì†Œ ë°”ë¦„ / ëŒ€í‘œ: ê¹€ìˆ˜ìš©<br>
        ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ë´‰ì€ì‚¬ë¡œ30ê¸¸ 68 6ì¸µ 35í˜¸<br>
        1533-9784 Â· <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f09c9192de92918295859db0979d91999cde939f9d">[email&#160;protected]</a><br>
        ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ 340-49-00912
      </p>
      
      <button class="submit-btn" style="margin-top:20px;" onclick="closeModal('privacyModal')">í™•ì¸</button>
    </div>
  </div>

  <!-- ì„±ê³µ ëª¨ë‹¬ -->
  <div id="successModal" class="modal-overlay">
    <div class="modal-content">
      <div class="success-icon">âœ“</div>
      <div class="success-title">ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</div>
      <div class="success-message">
        ì „ë¬¸ ìƒë‹´ì‚¬ê°€ ë¹ ë¥¸ ì‹œê°„ ë‚´ì—<br>ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.<br><br>
        <strong>ìƒë‹´ ê°€ëŠ¥ ì‹œê°„:</strong> í‰ì¼ 09:00 ~ 18:00
      </div>
      <button class="success-btn" onclick="closeModal('successModal')">í™•ì¸</button>
    </div>
  </div>

  <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
    // ============ ìœ ì…ê²½ë¡œ ì¶”ì  ============
    (function() {
      const KEY = 'first_referrer';
      if (!sessionStorage.getItem(KEY)) {
        const url = new URL(location.href);
        const fromParam = url.searchParams.get('from') || url.searchParams.get('utm_source') || 
                          url.searchParams.get('utm_medium') || url.searchParams.get('utm_campaign');
        const fullReferrer = document.referrer;
        let refValue = "ì§ì ‘ ë°©ë¬¸";

        if (fromParam) {
          refValue = `from/utm: ${fromParam}`;
        } else if (fullReferrer) {
          refValue = fullReferrer;
          if (fullReferrer.includes("blog.naver")) refValue = `ë„¤ì´ë²„ ë¸”ë¡œê·¸: ${fullReferrer}`;
          if (fullReferrer.includes("cafe.naver")) refValue = `ë„¤ì´ë²„ ì¹´í˜: ${fullReferrer}`;
          if (fullReferrer.includes("instagram")) refValue = `ì¸ìŠ¤íƒ€ê·¸ë¨: ${fullReferrer}`;
          if (fullReferrer.includes("youtube")) refValue = `ìœ íŠœë¸Œ: ${fullReferrer}`;
          if (fullReferrer.includes("facebook")) refValue = `í˜ì´ìŠ¤ë¶: ${fullReferrer}`;
          if (fullReferrer.includes("kakao")) refValue = `ì¹´ì¹´ì˜¤í†¡: ${fullReferrer}`;
        } else {
          refValue = `ëœë”©: ${location.href}`;
        }
        sessionStorage.setItem(KEY, refValue);
      }
    })();

    // ============ ë¶„ì„ ê²°ê³¼ ì €ì¥ ë³€ìˆ˜ ============
    let analysisResult = {
      limit: 0,
      rate: 0,
      probability: 0,
      products: [],
      bizCategory: ''
    };
    let selectedProduct = null;
    let isSubmitting = false;

    // ============ ë¶„ì„ ëª¨ë‹¬ í•¨ìˆ˜ ============
    function openAnalysisModal() {
      const modal = document.getElementById('analysisModal');
      if (modal) {
        modal.classList.add('show');
        document.body.style.overflow = 'hidden';
      }
    }

    // ============ ëª¨ë‹¬ í•¨ìˆ˜ ============
    function openModal(modalId, productInfo = null) {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.classList.add('show');
        document.body.style.overflow = 'hidden';
        
        // ìƒí’ˆ ì •ë³´ê°€ ìˆìœ¼ë©´ í‘œì‹œ
        if (productInfo && modalId === 'consultModal') {
          selectedProduct = productInfo;
          const productInfoDiv = document.getElementById('modalProductInfo');
          const productNameEl = document.getElementById('modalProductName');
          const productDetailEl = document.getElementById('modalProductDetail');
          
          productInfoDiv.style.display = 'block';
          productNameEl.textContent = `ğŸ“Œ ${productInfo.name} (${productInfo.org})`;
          productDetailEl.textContent = `ìµœëŒ€ ${formatLimit(productInfo.maxLimit)} | ê¸ˆë¦¬ ${productInfo.minRate}%~`;
        } else if (modalId === 'consultModal') {
          selectedProduct = null;
          document.getElementById('modalProductInfo').style.display = 'none';
        }
      }
    }

    function closeModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.classList.remove('show');
        document.body.style.overflow = '';
      }
    }

    // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
    document.addEventListener('click', function(e) {
      if (e.target.classList.contains('modal-overlay')) {
        e.target.classList.remove('show');
        document.body.style.overflow = '';
      }
    });

    // ============ Google Sheets ì „ì†¡ í•¨ìˆ˜ ============
    const SHEET_URL = 'https://script.google.com/macros/s/AKfycbzEWx8mkK4IJdDQHnbFaJPzxT8EzW9dcCLnsQRGWf0swJhb0IipF0FKzxPw8ejUM_uj/exec';

    function submitConsultForm(e) {
      e.preventDefault();
      
      if (isSubmitting) return;
      
      const name = document.getElementById('clientName').value.trim();
      const phone1 = document.getElementById('phone1').value;
      const phone2 = document.getElementById('phone2').value.trim();
      const phone3 = document.getElementById('phone3').value.trim();
      const agreePrivacy = document.getElementById('agreePrivacy').checked;
      
      // ìœ íš¨ì„± ê²€ì‚¬
      if (!name) { alert('ì„±í•¨ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
      if (!phone2 || !phone3 || phone2.length < 3 || phone3.length < 4) {
        alert('ì—°ë½ì²˜ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return;
      }
      if (!agreePrivacy) { alert('ê°œì¸ì •ë³´ì·¨ê¸‰ë°©ì¹¨ì— ë™ì˜í•´ì£¼ì„¸ìš”.'); return; }
      
      // ì¤‘ë³µ ì œì¶œ ì²´í¬
      const userKey = `submitted_${name}_${phone1}-${phone2}-${phone3}`;
      if (localStorage.getItem(userKey)) {
        alert('ì´ë¯¸ í•´ë‹¹ ì •ë³´ë¡œ ì ‘ìˆ˜ëœ ê¸°ë¡ì´ ìˆìŠµë‹ˆë‹¤.');
        return;
      }
      
      isSubmitting = true;
      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'ì „ì†¡ ì¤‘...';
      
      const now = new Date();
      const phoneNumber = `${phone1}-${phone2}-${phone3}`;
      
      // FormData ìƒì„±
      const fd = new FormData();
      fd.append('ì‘ì—… ë‚ ì§œ', now.toLocaleDateString('ko-KR'));
      fd.append('ì‘ì—… ì‹œê°„', now.toLocaleTimeString('ko-KR'));
      fd.append('ì‚¬ì—…ì¥ëª…(ìƒí˜¸)', userData.company || '');
      fd.append('ì‚¬ì—…ì í˜•íƒœ', userData.business_type || '');
      fd.append('ì—…ì¢…', userData.industry || '');
      fd.append('ì‚¬ì—…ì ì—…ë ¥', userData.business_career || '');
      fd.append('ìƒì‹œ ê·¼ë¡œì ìˆ˜', userData.employee_count || 0);
      fd.append('ê¸°ì—… ë¶„ë¥˜ (ìë™ íŒë‹¨)', analysisResult.bizCategory || '');
      fd.append('íŠ¹í—ˆ ë³´ìœ  ìˆ˜', userData.patent_count || 0);
      fd.append('ê¸°ê³„/ì„¤ë¹„ ë³´ìœ ', userData.has_machine || '');
      fd.append('ì˜¨ë¼ì¸ íŒë§¤ ì—¬ë¶€', userData.online_sales || '');
      fd.append('ì˜¤í”„ë¼ì¸ ë§¤ì¥', userData.offline_store || '');
      fd.append('í‚¤ì˜¤ìŠ¤í¬ ì‚¬ìš©', userData.kiosk || '');
      fd.append('ë°°ë‹¬ì•± ì‚¬ìš©', userData.delivery || '');
      fd.append('ìˆ™ë°•ì•± ì‚¬ìš©', userData.reservation || '');
      fd.append('ì—°í‰ê·  ë§¤ì¶œì•¡', userData.average_sales ? `${userData.average_sales}ë§Œì›` : '');
      fd.append('2ë…„ê°„ 10%ì´ìƒ ì„±ì¥', userData.sales_growth || '');
      fd.append('ë‹´ë³´ëŒ€ì¶œ ì”ì•¡', userData.mortgage_loan ? `${userData.mortgage_loan}ë§Œì›` : '0');
      fd.append('ì‹ ìš©ëŒ€ì¶œ ì”ì•¡', userData.credit_loan ? `${userData.credit_loan}ë§Œì›` : '0');
      fd.append('KCB ì‹ ìš©ì ìˆ˜', userData.KCB || '');
      fd.append('NICE ì‹ ìš©ì ìˆ˜', userData.NICE || '');
      fd.append('ì—°ì²´/ì²´ë‚© ì—¬ë¶€', userData.overdue || '');
      fd.append('ì˜ˆìƒ ëŒ€ì¶œ í•œë„', analysisResult.limit ? formatLimit(analysisResult.limit) : '');
      fd.append('ì˜ˆìƒ ê¸ˆë¦¬', analysisResult.rate ? `${analysisResult.rate}%` : '');
      
      // ì¶”ì²œ ìƒí’ˆ ëª©ë¡ (ì„ íƒí•œ ìƒí’ˆì´ ìˆìœ¼ë©´ ë§¨ ì•ì— í‘œì‹œ)
      let productNames = analysisResult.products.map(p => p.name);
      if (selectedProduct) {
        productNames = [selectedProduct.name + ' (ì„ íƒ)', ...productNames.filter(n => n !== selectedProduct.name)];
      }
      fd.append('ì¶”ì²œ ìƒí’ˆ ëª©ë¡', productNames.join(', '));
      
      fd.append('ë¶„ì„ ì¼ì‹œ', now.toLocaleString('ko-KR'));
      fd.append('ìœ ì…ê²½ë¡œ', sessionStorage.getItem('first_referrer') || 'UNKNOWN');
      fd.append('ê°œì¸ì •ë³´ìˆ˜ì§‘ë™ì˜', 'ë™ì˜');
      fd.append('ì„±í•¨(ì´ë¦„)', name);
      fd.append('ì—°ë½ì²˜', phoneNumber);
      
      fetch(SHEET_URL, {
        method: 'POST',
        body: fd
      })
      .then(() => {
        localStorage.setItem(userKey, 'submitted');
        closeModal('consultModal');
        openModal('successModal');
        // í¼ ë¦¬ì…‹
        document.getElementById('consultForm').reset();
      })
      .catch(err => {
        console.error('ì „ì†¡ ì˜¤ë¥˜:', err);
        alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      })
      .finally(() => {
        isSubmitting = false;
        submitBtn.disabled = false;
        submitBtn.textContent = 'ì •ì±…ìê¸ˆ ìƒë‹´ ì‹ ì²­í•˜ê¸°';
      });
    }

    // ============ ë¶„ì„ ì‹ ì²­ í¼ ì œì¶œ ============
    function submitAnalysisForm(e) {
      e.preventDefault();
      
      if (isSubmitting) return;
      
      const name = document.getElementById('analysisName').value.trim();
      const phone1 = document.getElementById('analysisPhone1').value;
      const phone2 = document.getElementById('analysisPhone2').value.trim();
      const phone3 = document.getElementById('analysisPhone3').value.trim();
      const agreePrivacy = document.getElementById('analysisAgreePrivacy').checked;
      
      if (!name || !phone2 || !phone3) {
        alert('ëª¨ë“  í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      if (!agreePrivacy) {
        alert('ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš©ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      if (phone2.length < 3 || phone3.length < 4) {
        alert('ì—°ë½ì²˜ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      // ì¤‘ë³µ ì²´í¬
      const phoneNumber = `${phone1}-${phone2}-${phone3}`;
      const userKey = `analysis_${phoneNumber}`;
      if (localStorage.getItem(userKey)) {
        alert('ì´ë¯¸ ë¶„ì„ ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\nìƒë‹´ì‚¬ê°€ ê³§ ì—°ë½ë“œë¦´ ì˜ˆì •ì…ë‹ˆë‹¤.');
        return;
      }
      
      isSubmitting = true;
      const submitBtn = document.getElementById('analysisSubmitBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'ì‹ ì²­ ì¤‘...';
      
      const fd = new FormData();
      const now = new Date();
      fd.append('ì‘ì—…ë‚ ì§œ', now.toLocaleDateString('ko-KR'));
      fd.append('ì‘ì—…ì‹œê°„', now.toLocaleTimeString('ko-KR'));
      
      // ì‚¬ì—…ì ì •ë³´
      fd.append('ì‚¬ì—…ìë¶„ë¥˜', userData.company || '');
      fd.append('ì‚¬ì—…ìì¢…ë¥˜', userData.business_type || '');
      fd.append('ì—…ì¢…', userData.industry || '');
      fd.append('ì—…ë ¥', userData.business_career || '');
      fd.append('íŠ¹í—ˆì—¬ë¶€', userData.patent_count > 0 ? 'ìˆìŒ' : 'ì—†ìŒ');
      fd.append('ê¸°ê³„ì„¤ë¹„ì—¬ë¶€', userData.has_machine || '');
      fd.append('ì—°ê°„ë§¤ì¶œì•¡', userData.average_sales ? `${userData.average_sales}ë§Œì›` : '');
      fd.append('ë§¤ì¶œì„±ì¥ë¥ ', userData.sales_growth || '');
      fd.append('ë‹´ë³´ëŒ€ì¶œì”ì•¡', userData.mortgage_loan ? `${userData.mortgage_loan}ë§Œì›` : '0');
      fd.append('ì‹ ìš©ëŒ€ì¶œì”ì•¡', userData.credit_loan ? `${userData.credit_loan}ë§Œì›` : '0');
      fd.append('KCB ì‹ ìš©ì ìˆ˜', userData.KCB || '');
      fd.append('NICE ì‹ ìš©ì ìˆ˜', userData.NICE || '');
      fd.append('ì—°ì²´/ì²´ë‚© ì—¬ë¶€', userData.overdue || '');
      fd.append('ì‹ ì²­ìœ í˜•', 'ë¶„ì„ ì „ ì‹ ì²­');
      fd.append('UTM source', sessionStorage.getItem('utm_source') || '');
      fd.append('UTM medium', sessionStorage.getItem('utm_medium') || '');
      fd.append('UTM campaign', sessionStorage.getItem('utm_campaign') || '');
      fd.append('ìœ ì…ê²½ë¡œ', sessionStorage.getItem('first_referrer') || 'UNKNOWN');
      fd.append('ê°œì¸ì •ë³´ìˆ˜ì§‘ë™ì˜', 'ë™ì˜');
      fd.append('ì„±í•¨(ì´ë¦„)', name);
      fd.append('ì—°ë½ì²˜', phoneNumber);
      
      fetch(SHEET_URL, {
        method: 'POST',
        body: fd
      })
      .then(() => {
        localStorage.setItem(userKey, 'submitted');
        closeModal('analysisModal');
        
        // ì™„ë£Œ ë©”ì‹œì§€ í‘œì‹œ
        const chatMessages = document.getElementById('chatMessages');
        const wrapper = document.createElement('div');
        wrapper.className = 'message-wrapper bot';
        wrapper.innerHTML = `
          <div class="bot-avatar">ğŸ¤–</div>
          <div class="message-content">
            <div class="section-badge">ì‹ ì²­ ì™„ë£Œ</div>
            <div class="message-bubble bot">
              <div class="message-text">
                <strong>âœ… ë¶„ì„ ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</strong><br><br>
                ${name}ë‹˜, ê°ì‚¬í•©ë‹ˆë‹¤.<br><br>
                ì „ë¬¸ ìƒë‹´ì‚¬ê°€ <strong>ë¹ ë¥¸ ì‹œê°„ ë‚´ì—</strong><br>
                <strong>${phoneNumber}</strong>ë¡œ ì—°ë½ë“œë¦´ ì˜ˆì •ì…ë‹ˆë‹¤.<br><br>
                ğŸ“ ë§ì¶¤ ì •ì±…ìê¸ˆ ë¶„ì„ ê²°ê³¼ì™€<br>
                ë¬´ë£Œ ìë¬¸ ìƒë‹´ì„ ë°›ì•„ë³´ì„¸ìš”!
              </div>
              <button class="restart-btn" onclick="resetChat()" style="margin-top:16px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15" />
                </svg>
                <span>ì²˜ìŒë¶€í„° ë‹¤ì‹œí•˜ê¸°</span>
              </button>
            </div>
            <span class="message-time">${getTime()}</span>
          </div>
        `;
        chatMessages.appendChild(wrapper);
        scrollToBottom();
        
        // í¼ ë¦¬ì…‹
        document.getElementById('analysisForm').reset();
      })
      .catch(err => {
        alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      })
      .finally(() => {
        isSubmitting = false;
        submitBtn.disabled = false;
        submitBtn.textContent = 'âœ… ìê¸ˆë¶„ì„ê²°ê³¼ Â· ë¬´ë£Œìë¬¸ìƒë‹´ ë°›ê¸°';
      });
    }

    // ì „í™”ë²ˆí˜¸ ì…ë ¥ ì‹œ ìˆ«ìë§Œ í—ˆìš©
    document.addEventListener('DOMContentLoaded', function() {
      ['phone2', 'phone3', 'analysisPhone2', 'analysisPhone3'].forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          el.addEventListener('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '');
          });
        }
      });
    });

    // ============ ë°ì´í„° ì •ì˜ ============
    const industryQuestions = {
      'ì œì¡°ì—…': ['patent', 'machine'],
      'ê±´ì„¤ì—…': ['patent', 'machine'],
      'ë„ì†Œë§¤ì—…': ['online', 'offline', 'kiosk'],
      'ìš”ì‹ì—…': ['delivery', 'kiosk'],
      'ìˆ™ë°•ì—…': ['reservation', 'kiosk'],
      'SW/ITì—…': ['patent'],
      'ì„œë¹„ìŠ¤ì—…': ['patent'],
      'ìš´ì†¡ì—…': [],
      'ê¸°íƒ€': []
    };

    // ì •ì±…ìê¸ˆ ìƒí’ˆ ë°ì´í„°ë² ì´ìŠ¤
    // ============ ì†Œìƒê³µì¸ ì •ì±…ìê¸ˆ (ì†Œì§„ê³µ, ì§€ì—­ì‹ ë³´, ì„œë¯¼ê¸ˆìœµì§„í¥ì›) ============
    const smallBizFunds = {
      general_stable: {
        name: 'ì¼ë°˜ê²½ì˜ì•ˆì •ìê¸ˆ',
        org: 'ì†Œì§„ê³µ',
        target: 'ì†Œìƒê³µì¸ (ì—…ë ¥ ë¬´ê´€)',
        maxLimit: 7000,
        minRate: 3.58,
        period: '5ë…„(2ë…„ ê±°ì¹˜)',
        method: 'ëŒ€ë¦¬ëŒ€ì¶œ',
        desc: 'ì†Œìƒê³µì¸ ê²½ì˜ì•ˆì • ìš´ì „ìê¸ˆ'
      },
      emergency_disaster: {
        name: 'ê¸´ê¸‰ê²½ì˜ì•ˆì •ìê¸ˆ(ì¬í•´)',
        org: 'ì†Œì§„ê³µ',
        target: 'ì¬í•´í”¼í•´ ì†Œìƒê³µì¸',
        maxLimit: 10000,
        minRate: 2.0,
        period: '5ë…„(2ë…„ ê±°ì¹˜)',
        method: 'ì§ì ‘/ëŒ€ë¦¬ëŒ€ì¶œ',
        desc: 'ìì—°ì¬í•´Â·ì‚¬íšŒì¬ë‚œ í”¼í•´ ì†Œìƒê³µì¸ ê¸´ê¸‰ì§€ì›'
      },
      emergency_crisis: {
        name: 'ê¸´ê¸‰ê²½ì˜ì•ˆì •ìê¸ˆ(ê²½ì˜ì• ë¡œ)',
        org: 'ì†Œì§„ê³µ',
        target: 'ì¼ì‹œì  ê²½ì˜ì• ë¡œ ì†Œìƒê³µì¸',
        maxLimit: 7000,
        minRate: 2.98,
        period: '5ë…„(2ë…„ ê±°ì¹˜)',
        method: 'ì§ì ‘/ëŒ€ë¦¬ëŒ€ì¶œ',
        desc: 'ë§¤ì¶œ 10% ì´ìƒ ê°ì†Œ ì†Œìƒê³µì¸ ì§€ì›'
      },
      disabled: {
        name: 'ì¥ì• ì¸ê¸°ì—…ì§€ì›ìê¸ˆ',
        org: 'ì†Œì§„ê³µ',
        target: 'ì¥ì• ì¸ ì†Œìƒê³µì¸',
        maxLimit: 10000,
        minRate: 2.0,
        period: '7ë…„(2ë…„ ê±°ì¹˜)',
        method: 'ëŒ€ë¦¬ëŒ€ì¶œ',
        desc: 'ì¥ì• ì¸ë³µì§€ì¹´ë“œ ì†Œì§€ ì†Œìƒê³µì¸ ìš°ëŒ€'
      },
      low_credit: {
        name: 'ì‹ ìš©ì·¨ì•½ì†Œìƒê³µì¸ìê¸ˆ',
        org: 'ì†Œì§„ê³µ',
        target: 'NCB 839ì  ì´í•˜ ì†Œìƒê³µì¸',
        maxLimit: 3000,
        minRate: 4.58,
        period: '5ë…„(2ë…„ ê±°ì¹˜)',
        method: 'ì§ì ‘ëŒ€ì¶œ',
        desc: 'ì¤‘Â·ì €ì‹ ìš© ì†Œìƒê³µì¸ ìê¸ˆì§€ì›'
      },
      restart_hope: {
        name: 'ì¬ë„ì „íŠ¹ë³„ìê¸ˆ(í¬ë§í˜•)',
        org: 'ì†Œì§„ê³µ',
        target: 'í¬ë§ë¦¬í„´íŒ¨í‚¤ì§€ ìˆ˜í˜œ ì†Œìƒê³µì¸',
        maxLimit: 10000,
        minRate: 3.58,
        period: '5ë…„(2ë…„ ê±°ì¹˜)',
        method: 'ì§ì ‘ëŒ€ì¶œ',
        desc: 'ì¬ì°½ì—… ì¤€ë¹„ ì†Œìƒê³µì¸ ì§€ì›'
      },
      restart_general: {
        name: 'ì¬ë„ì „íŠ¹ë³„ìê¸ˆ(ì¼ë°˜í˜•)',
        org: 'ì†Œì§„ê³µ',
        target: 'ì¬ì°½ì—…/ì±„ë¬´ì¡°ì • ì†Œìƒê³µì¸',
        maxLimit: 7000,
        minRate: 4.58,
        period: '5ë…„(2ë…„ ê±°ì¹˜)',
        method: 'ì§ì ‘ëŒ€ì¶œ',
        desc: 'ì¬ì°½ì—… ì´ˆê¸°ë‹¨ê³„ ì†Œìƒê³µì¸ ì§€ì›'
      },
      youth_employ: {
        name: 'ì²­ë…„ê³ ìš©ì—°ê³„ìê¸ˆ',
        org: 'ì†Œì§„ê³µ',
        target: 'ì²­ë…„ëŒ€í‘œ ë˜ëŠ” ì²­ë…„ê³ ìš© ì†Œìƒê³µì¸',
        maxLimit: 7000,
        minRate: 2.98,
        period: '5ë…„(2ë…„ ê±°ì¹˜)',
        method: 'ëŒ€ë¦¬ëŒ€ì¶œ',
        desc: 'ë§Œ39ì„¸ ì´í•˜ ì²­ë…„ ì†Œìƒê³µì¸ ì§€ì›'
      },
      small_manufacturer: {
        name: 'ì†Œê³µì¸íŠ¹í™”ìê¸ˆ',
        org: 'ì†Œì§„ê³µ',
        target: 'ì œì¡°ì—… ì†Œê³µì¸ (10ì¸ ë¯¸ë§Œ)',
        maxLimit: 50000,
        minRate: 3.58,
        period: 'ìš´ì „5ë…„/ì‹œì„¤8ë…„',
        method: 'ëŒ€ë¦¬ëŒ€ì¶œ',
        desc: 'ìˆ™ë ¨ê¸°ìˆ  ê¸°ë°˜ ì œì¡°ì—… ì†Œê³µì¸ ì§€ì›'
      },
      innovation_growth: {
        name: 'í˜ì‹ ì„±ì¥ì´‰ì§„ìê¸ˆ',
        org: 'ì†Œì§„ê³µ',
        target: 'ìˆ˜ì¶œ/ë§¤ì¶œì„±ì¥/ìŠ¤ë§ˆíŠ¸ ì†Œìƒê³µì¸',
        maxLimit: 100000,
        minRate: 3.38,
        period: 'ìš´ì „5ë…„/ì‹œì„¤8ë…„',
        method: 'ì§ì ‘ëŒ€ì¶œ',
        desc: 'í˜ì‹ í˜• ì†Œìƒê³µì¸ ì„±ì¥ê¸°ë°˜ ì§€ì›'
      },
      matching_invest: {
        name: 'ë¯¼ê°„íˆ¬ìì—°ê³„í˜• ë§¤ì¹­ìœµì',
        org: 'ì†Œì§„ê³µ',
        target: 'ë¯¼ê°„íˆ¬ì ìœ ì¹˜ ì†Œìƒê³µì¸',
        maxLimit: 50000,
        minRate: 3.38,
        period: '8ë…„(3ë…„ ê±°ì¹˜)',
        method: 'ì§ì ‘ëŒ€ì¶œ',
        desc: 'ë¯¼ê°„íˆ¬ìê¸ˆ ìµœëŒ€ 5ë°° ë§¤ì¹­'
      },
      refinance: {
        name: 'ëŒ€í™˜ëŒ€ì¶œ',
        org: 'ì†Œì§„ê³µ',
        target: 'ê³ ê¸ˆë¦¬ ëŒ€ì¶œ ë³´ìœ  ì†Œìƒê³µì¸',
        maxLimit: 5000,
        minRate: 4.5,
        period: '10ë…„(2ë…„ ê±°ì¹˜)',
        method: 'ì§ì ‘ëŒ€ì¶œ',
        desc: 'ê³ ê¸ˆë¦¬ ëŒ€ì¶œ ì €ê¸ˆë¦¬ ì „í™˜'
      },
      local_guarantee: {
        name: 'ì§€ì—­ì‹ ìš©ë³´ì¦ì¬ë‹¨ ë³´ì¦',
        org: 'ì§€ì—­ì‹ ë³´',
        target: 'ì†Œê¸°ì—…Â·ì†Œìƒê³µì¸',
        maxLimit: 80000,
        minRate: 3.0,
        period: 'ë³´ì¦ê¸°ê°„ 1ë…„~5ë…„',
        method: 'ë³´ì¦ì„œë¶€ ëŒ€ì¶œ',
        desc: 'ì‹ ìš©ë³´ì¦ì„œ ë°œê¸‰ìœ¼ë¡œ ëŒ€ì¶œ ì§€ì›'
      },
      miso_finance: {
        name: 'ë¯¸ì†Œê¸ˆìœµ',
        org: 'ì„œë¯¼ê¸ˆìœµì§„í¥ì›',
        target: 'NCB 749ì  ì´í•˜ ì†Œìƒê³µì¸',
        maxLimit: 7000,
        minRate: 4.5,
        period: '5ë…„(1ë…„ ê±°ì¹˜)',
        method: 'ì§ì ‘ëŒ€ì¶œ',
        desc: 'ì €ì‹ ìš©Â·ì €ì†Œë“ ì†Œìƒê³µì¸ ì§€ì›'
      }
    };

    // ============ ì¤‘ì†Œê¸°ì—… ì •ì±…ìê¸ˆ (ì¤‘ì§„ê³µ, ì‹ ìš©ë³´ì¦ê¸°ê¸ˆ, ê¸°ìˆ ë³´ì¦ê¸°ê¸ˆ) ============
    const smeFunds = {
      startup_base: {
        name: 'ì°½ì—…ê¸°ë°˜ì§€ì›ìê¸ˆ',
        org: 'ì¤‘ì§„ê³µ',
        target: 'ì—…ë ¥ 7ë…„ ë¯¸ë§Œ ì°½ì—…ê¸°ì—…',
        maxLimit: 600000,
        minRate: 2.68,
        period: 'ì‹œì„¤10ë…„/ìš´ì „5ë…„',
        method: 'ì§ì ‘/ëŒ€ë¦¬ëŒ€ì¶œ',
        desc: 'ì°½ì—…ì´ˆê¸° ê¸°ì—… ì¢…í•© ìê¸ˆì§€ì›'
      },
      youth_startup: {
        name: 'ì²­ë…„ì „ìš©ì°½ì—…ìê¸ˆ',
        org: 'ì¤‘ì§„ê³µ',
        target: 'ë§Œ39ì„¸ ì´í•˜, ì—…ë ¥ 3ë…„ ë¯¸ë§Œ',
        maxLimit: 20000,
        minRate: 2.5,
        period: 'ì‹œì„¤10ë…„/ìš´ì „6ë…„',
        method: 'ì§ì ‘ëŒ€ì¶œ',
        desc: 'ì²­ë…„ ì°½ì—…ì ê³ ì •ê¸ˆë¦¬ ìš°ëŒ€'
      },
      tech_commercialize: {
        name: 'ê°œë°œê¸°ìˆ ì‚¬ì—…í™”ìê¸ˆ',
        org: 'ì¤‘ì§„ê³µ',
        target: 'íŠ¹í—ˆ/R&D ë³´ìœ  ê¸°ìˆ ê¸°ì—…',
        maxLimit: 600000,
        minRate: 2.98,
        period: 'ì‹œì„¤10ë…„/ìš´ì „5ë…„',
        method: 'ì§ì ‘ëŒ€ì¶œ',
        desc: 'ê¸°ìˆ ì‚¬ì—…í™” ì¶”ì§„ê¸°ì—… ì§€ì›'
      },
      export_domestic: {
        name: 'ë‚´ìˆ˜ê¸°ì—…ìˆ˜ì¶œê¸°ì—…í™”',
        org: 'ì¤‘ì§„ê³µ',
        target: 'ìˆ˜ì¶œ 10ë§Œë¶ˆ ë¯¸ë§Œ ê¸°ì—…',
        maxLimit: 50000,
        minRate: 2.98,
        period: 'ìš´ì „5ë…„(2ë…„ ê±°ì¹˜)',
        method: 'ì§ì ‘ëŒ€ì¶œ',
        desc: 'ìˆ˜ì¶œ ì´ˆë³´ê¸°ì—… ìœ¡ì„± ì§€ì›'
      },
      export_global: {
        name: 'ìˆ˜ì¶œê¸°ì—…ê¸€ë¡œë²Œí™”',
        org: 'ì¤‘ì§„ê³µ',
        target: 'ìˆ˜ì¶œ 10ë§Œë¶ˆ ì´ìƒ ê¸°ì—…',
        maxLimit: 600000,
        minRate: 3.18,
        period: 'ì‹œì„¤10ë…„/ìš´ì „5ë…„',
        method: 'ì§ì ‘/ì´ì°¨ë³´ì „',
        desc: 'ìˆ˜ì¶œ ì¤‘ì†Œê¸°ì—… ê¸€ë¡œë²Œí™” ì§€ì›'
      },
      innovation_growth_sme: {
        name: 'í˜ì‹ ì„±ì¥ì§€ì›ìê¸ˆ',
        org: 'ì¤‘ì§„ê³µ',
        target: 'ì—…ë ¥ 7ë…„ ì´ìƒ ì„±ì¥ê¸°ì—…',
        maxLimit: 1000000,
        minRate: 3.48,
        period: 'ì‹œì„¤10ë…„/ìš´ì „5ë…„',
        method: 'ì§ì ‘/ëŒ€ë¦¬/ì´ì°¨ë³´ì „',
        desc: 'ì„±ì¥ìœ ë§ ì¤‘ì†Œê¸°ì—… ì‹œì„¤íˆ¬ì ì§€ì›'
      },
      net_zero: {
        name: 'Net-Zero ìœ ë§ê¸°ì—…ì§€ì›',
        org: 'ì¤‘ì§„ê³µ',
        target: 'íƒ„ì†Œì¤‘ë¦½Â·ê·¸ë¦° ê¸°ìˆ ê¸°ì—…',
        maxLimit: 600000,
        minRate: 2.98,
        period: 'ì‹œì„¤10ë…„/ìš´ì „5ë…„',
        method: 'ì§ì ‘/ëŒ€ë¦¬/ì´ì°¨ë³´ì „',
        desc: 'ê·¸ë¦°ë¶„ì•¼ ê¸°ìˆ ì‚¬ì—…í™” ì§€ì›'
      },
      smart_factory: {
        name: 'ì œì¡°í˜„ì¥ìŠ¤ë§ˆíŠ¸í™”',
        org: 'ì¤‘ì§„ê³µ',
        target: 'ìŠ¤ë§ˆíŠ¸ê³µì¥ ë„ì… ê¸°ì—…',
        maxLimit: 1000000,
        minRate: 2.98,
        period: 'ì‹œì„¤10ë…„/ìš´ì „5ë…„',
        method: 'ì§ì ‘/ëŒ€ë¦¬/ì´ì°¨ë³´ì „',
        desc: 'ìŠ¤ë§ˆíŠ¸ê³µì¥Â·ìë™í™” ì‹œì„¤ ì§€ì›'
      },
      business_change: {
        name: 'ì‚¬ì—…ì „í™˜ìê¸ˆ',
        org: 'ì¤‘ì§„ê³µ',
        target: 'ì‚¬ì—…ì „í™˜ê³„íš ìŠ¹ì¸ê¸°ì—…',
        maxLimit: 1000000,
        minRate: 3.18,
        period: 'ì‹œì„¤10ë…„/ìš´ì „6ë…„',
        method: 'ì§ì ‘/ëŒ€ë¦¬ëŒ€ì¶œ',
        desc: 'ì—…ì¢…ì „í™˜Â·ì‹ ì‚¬ì—… ì¶”ì§„ê¸°ì—… ì§€ì›'
      },
      emergency_sme: {
        name: 'ê¸´ê¸‰ê²½ì˜ì•ˆì •ìê¸ˆ',
        org: 'ì¤‘ì§„ê³µ',
        target: 'ì¬í•´Â·ê²½ì˜ìœ„ê¸° ì¤‘ì†Œê¸°ì—…',
        maxLimit: 100000,
        minRate: 1.9,
        period: 'ìš´ì „5ë…„(2ë…„ ê±°ì¹˜)',
        method: 'ì§ì ‘ëŒ€ì¶œ',
        desc: 'ìì—°ì¬í•´Â·ì‚¬íšŒì¬ë‚œ í”¼í•´ê¸°ì—… ê¸´ê¸‰ì§€ì›'
      },
      kodit_general: {
        name: 'ì‹ ìš©ë³´ì¦ê¸°ê¸ˆ ë³´ì¦',
        org: 'ì‹ ìš©ë³´ì¦ê¸°ê¸ˆ',
        target: 'ì¤‘ì†Œê¸°ì—… ì „ë°˜',
        maxLimit: 300000,
        minRate: 3.0,
        period: 'ë³´ì¦ê¸°ê°„ 1ë…„~3ë…„',
        method: 'ë³´ì¦ì„œë¶€ ëŒ€ì¶œ',
        desc: 'ì‹ ìš©ë³´ì¦ì„œ ë°œê¸‰ìœ¼ë¡œ ë‹´ë³´ ëŒ€ì²´'
      },
      kibo_tech: {
        name: 'ê¸°ìˆ ë³´ì¦ê¸°ê¸ˆ ë³´ì¦',
        org: 'ê¸°ìˆ ë³´ì¦ê¸°ê¸ˆ',
        target: 'ê¸°ìˆ ë ¥ ë³´ìœ  ì¤‘ì†Œê¸°ì—…',
        maxLimit: 300000,
        minRate: 2.8,
        period: 'ë³´ì¦ê¸°ê°„ 1ë…„~3ë…„',
        method: 'ë³´ì¦ì„œë¶€ ëŒ€ì¶œ',
        desc: 'ê¸°ìˆ í‰ê°€ ê¸°ë°˜ ë³´ì¦ì„œ ë°œê¸‰'
      },
      startup_nest: {
        name: 'ì°½ì—…ê¸°ì—…ìœ¡ì„±(Start-up NEST)',
        org: 'ì‹ ìš©ë³´ì¦ê¸°ê¸ˆ',
        target: 'ì—…ë ¥ 7ë…„ ë¯¸ë§Œ ì°½ì—…ê¸°ì—…',
        maxLimit: 100000,
        minRate: 2.5,
        period: 'ë³´ì¦ê¸°ê°„ ìµœëŒ€ 3ë…„',
        method: 'ë³´ì¦ì„œë¶€ ëŒ€ì¶œ',
        desc: 'ì°½ì—…ê¸°ì—… ì „ìš© ë³´ì¦ í”„ë¡œê·¸ë¨'
      },
      restart_sme: {
        name: 'ì¬ë„ì „ì¬ê¸°ì§€ì›ë³´ì¦',
        org: 'ê¸°ìˆ ë³´ì¦ê¸°ê¸ˆ',
        target: 'ì„±ì‹¤ì‹¤íŒ¨ ì¬ì°½ì—… ê¸°ì—…',
        maxLimit: 80000,
        minRate: 2.5,
        period: 'ë³´ì¦ê¸°ê°„ ìµœëŒ€ 5ë…„',
        method: 'ë³´ì¦ì„œë¶€ ëŒ€ì¶œ',
        desc: 'ì¬ì°½ì—… ê¸°ì—… íŠ¹ë¡€ë³´ì¦'
      }
    };

    let currentStep = 0;
    let questions = [];
    let userData = {
      company: '', business_type: '', industry: '', business_career: '',
      employee_count: 0, patent_count: 0, has_machine: '', online_sales: '', offline_store: '',
      kiosk: '', delivery: '', reservation: '', average_sales: 0,
      sales_growth: '', mortgage_loan: 0, credit_loan: 0, KCB: 0, NICE: 0, overdue: ''
    };

    // ì†Œìƒê³µì¸/ì¤‘ì†Œê¸°ì—… íŒë‹¨ í•¨ìˆ˜
    function isSmallBusiness(data) {
      const manufacturingIndustries = ['ì œì¡°ì—…', 'ê±´ì„¤ì—…', 'ìš´ì†¡ì—…'];
      const employeeLimit = manufacturingIndustries.includes(data.industry) ? 10 : 5;
      
      // ìƒì‹œê·¼ë¡œì ìˆ˜ ê¸°ì¤€
      if (data.employee_count >= employeeLimit) return false;
      
      // ë§¤ì¶œì•¡ ê¸°ì¤€ (ì—…ì¢…ë³„ ì†Œê¸°ì—… ê¸°ì¤€ì˜ 30% ë¯¸ë§Œì´ë©´ ì†Œìƒê³µì¸ìœ¼ë¡œ ê°€ì •)
      // ê°„ì´ê³¼ì„¸ìëŠ” ë¬´ì¡°ê±´ ì†Œìƒê³µì¸
      if (data.average_sales < 10000) return true; // 1ì–µ ë¯¸ë§Œì€ ì†Œìƒê³µì¸
      if (data.average_sales >= 100000) return false; // 10ì–µ ì´ìƒì€ ì¤‘ì†Œê¸°ì—…ê¸‰
      
      return true; // ê¸°ë³¸ì ìœ¼ë¡œ ì†Œìƒê³µì¸ìœ¼ë¡œ ë¶„ë¥˜
    }

    // ============ ì§ˆë¬¸ ìƒì„± ============
    function getQuestions(industry) {
      const base = [
        { key: 'start', text: 'ì•ˆë…•í•˜ì„¸ìš”! ğŸ‘‹\n\nì •ì±…ìê¸ˆ í•œë„Â·ê¸ˆë¦¬Â·ìƒí’ˆ ì¶”ì²œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.\n\n2025ë…„ ì •ë¶€ ì •ì±…ê¸ˆìœµ ì§€ì› ê·œëª¨ 26.5ì¡° ì›!\nìµœì ì˜ ì •ì±…ìê¸ˆì„ ì°¾ì•„ë“œë¦´ê²Œìš”.', type: 'button', options: ['ë¶„ì„ ì‹œì‘í•˜ê¸°'], section: 'intro' },
        { key: 'company', text: 'ì‚¬ì—…ì¥ëª…(ìƒí˜¸)ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', type: 'text', placeholder: 'ì˜ˆ: ë°”ë¦„ì—°êµ¬ì†Œ', section: 'ì‚¬ì—…ì ì •ë³´' },
        { key: 'business_type', text: 'ì‚¬ì—…ì í˜•íƒœë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', type: 'choice', options: ['ê°œì¸ì‚¬ì—…ì', 'ë²•ì¸ì‚¬ì—…ì'], section: 'ì‚¬ì—…ì ì •ë³´' },
        { key: 'industry', text: 'ì—…ì¢…ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', type: 'choice', options: ['ì œì¡°ì—…', 'ë„ì†Œë§¤ì—…', 'ê±´ì„¤ì—…', 'ìš”ì‹ì—…', 'ìˆ™ë°•ì—…', 'ìš´ì†¡ì—…', 'SW/ITì—…', 'ì„œë¹„ìŠ¤ì—…', 'ê¸°íƒ€'], section: 'ì‚¬ì—…ì ì •ë³´' },
        { key: 'business_career', text: 'ì‚¬ì—…ì ì—…ë ¥ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', type: 'choice', options: ['1ë…„ ë¯¸ë§Œ', '3ë…„ ë¯¸ë§Œ', '5ë…„ ë¯¸ë§Œ', '7ë…„ ë¯¸ë§Œ', '7ë…„ ì´ìƒ'], section: 'ì‚¬ì—…ì ì •ë³´' },
        { key: 'employee_count', text: 'ìƒì‹œ ê·¼ë¡œì ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\n(ëŒ€í‘œì ì œì™¸, ì¼ìš©ì§ ì œì™¸)\n\nğŸ’¡ 5ì¸ ë¯¸ë§Œ: ì†Œìƒê³µì¸ / 5ì¸ ì´ìƒ: ì¤‘ì†Œê¸°ì—…', type: 'number', placeholder: 'ì˜ˆ: 3', section: 'ì‚¬ì—…ì ì •ë³´' }
      ];

      const industrySpecific = [];
      const fields = industryQuestions[industry] || [];
      
      if (fields.includes('patent')) industrySpecific.push({ key: 'patent_count', text: 'ë³´ìœ  ì¤‘ì¸ íŠ¹í—ˆ ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\n\nğŸ’¡ íŠ¹í—ˆ ë³´ìœ  ì‹œ ê¸°ìˆ ì‚¬ì—…í™”ìê¸ˆ ìš°ëŒ€!', type: 'number', placeholder: 'ì—†ìœ¼ë©´ 0', section: 'ì—…ì¢…ë³„ ì •ë³´', icon: 'ğŸ“œ' });
      if (fields.includes('machine')) industrySpecific.push({ key: 'has_machine', text: 'ê¸°ê³„/ì„¤ë¹„ ë³´ìœ  ì—¬ë¶€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.\n\nğŸ’¡ ì„¤ë¹„ ë³´ìœ  ì‹œ ë‹´ë³´ í™œìš© ê°€ëŠ¥!', type: 'choice', options: ['ë³´ìœ í•¨', 'ë³´ìœ  ì•ˆí•¨'], section: 'ì—…ì¢…ë³„ ì •ë³´', icon: 'âš™ï¸' });
      if (fields.includes('online')) industrySpecific.push({ key: 'online_sales', text: 'ì˜¨ë¼ì¸ íŒë§¤ë¥¼ í•˜ì‹œë‚˜ìš”?\n\nğŸ’¡ ì˜¨ë¼ì¸ íŒë§¤ ì‹œ ìŠ¤ë§ˆíŠ¸ìƒì  ìš°ëŒ€!', type: 'choice', options: ['ì˜ˆ', 'ì•„ë‹ˆì˜¤'], section: 'ì—…ì¢…ë³„ ì •ë³´', icon: 'ğŸ›’' });
      if (fields.includes('offline')) industrySpecific.push({ key: 'offline_store', text: 'ì˜¤í”„ë¼ì¸ ë§¤ì¥ì„ ë³´ìœ í•˜ê³  ê³„ì‹ ê°€ìš”?', type: 'choice', options: ['ë³´ìœ í•¨', 'ë³´ìœ  ì•ˆí•¨'], section: 'ì—…ì¢…ë³„ ì •ë³´', icon: 'ğŸª' });
      if (fields.includes('kiosk')) industrySpecific.push({ key: 'kiosk', text: 'í‚¤ì˜¤ìŠ¤í¬ë¥¼ ì‚¬ìš©í•˜ì‹œë‚˜ìš”?\n\nğŸ’¡ í‚¤ì˜¤ìŠ¤í¬ ì‚¬ìš© ì‹œ ìŠ¤ë§ˆíŠ¸ì†Œìƒê³µì¸ ìš°ëŒ€!', type: 'choice', options: ['ì‚¬ìš©í•¨', 'ì‚¬ìš© ì•ˆí•¨'], section: 'ì—…ì¢…ë³„ ì •ë³´', icon: 'ğŸ–¥ï¸' });
      if (fields.includes('delivery')) industrySpecific.push({ key: 'delivery', text: 'ë°°ë‹¬ì•±ì„ ì‚¬ìš©í•˜ì‹œë‚˜ìš”?\n\nğŸ’¡ ë°°ë‹¬ì•± í™œìš© ì‹œ í•œë„ 60%ê¹Œì§€ í™•ëŒ€!', type: 'choice', options: ['ì‚¬ìš©í•¨', 'ì‚¬ìš© ì•ˆí•¨'], section: 'ì—…ì¢…ë³„ ì •ë³´', icon: 'ğŸ›µ' });
      if (fields.includes('reservation')) industrySpecific.push({ key: 'reservation', text: 'ìˆ™ë°•ì•±(ì•¼ë†€ì, ì—¬ê¸°ì–´ë•Œ ë“±)ì„ ì‚¬ìš©í•˜ì‹œë‚˜ìš”?', type: 'choice', options: ['ì‚¬ìš©í•¨', 'ì‚¬ìš© ì•ˆí•¨'], section: 'ì—…ì¢…ë³„ ì •ë³´', icon: 'ğŸ¨' });

      const remaining = [
        { key: 'average_sales', text: '1ë…„ í‰ê·  ë§¤ì¶œì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\n(ë‹¨ìœ„: ë§Œì›)\n\nğŸ’¡ ë§¤ì¶œì´ ë†’ì„ìˆ˜ë¡ í•œë„ê°€ ì»¤ì§‘ë‹ˆë‹¤!', type: 'number', placeholder: 'ì˜ˆ: 50000 (5ì–µì›)', section: 'ë§¤ì¶œ ì •ë³´' },
        { key: 'sales_growth', text: 'ìµœê·¼ 2ë…„ê°„ ë§¤ì¶œì´ 10% ì´ìƒ ì„±ì¥í–ˆë‚˜ìš”?\n\nğŸ’¡ ì„±ì¥ê¸°ì—…ì€ ê¸ˆë¦¬ 0.2%p ìš°ëŒ€!', type: 'choice', options: ['ì˜ˆ', 'ì•„ë‹ˆì˜¤'], section: 'ë§¤ì¶œ ì •ë³´' },
        { key: 'mortgage_loan', text: 'í˜„ì¬ ë‹´ë³´ëŒ€ì¶œ ì”ì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\n(ë‹¨ìœ„: ë§Œì›)', type: 'number', placeholder: 'ì—†ìœ¼ë©´ 0', section: 'ëŒ€ì¶œ ì •ë³´' },
        { key: 'credit_loan', text: 'í˜„ì¬ ì‹ ìš©ëŒ€ì¶œ ì”ì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\n(ë‹¨ìœ„: ë§Œì›)\n\nğŸ’¡ ê¸°ì¡´ ë¶€ì±„ê°€ ì ì„ìˆ˜ë¡ ìŠ¹ì¸ í™•ë¥  UP!', type: 'number', placeholder: 'ì—†ìœ¼ë©´ 0', section: 'ëŒ€ì¶œ ì •ë³´' },
        { key: 'KCB', text: 'KCB ì‹ ìš©ì ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\n\nğŸ’¡ ëª¨ë¥´ì‹œë©´ ì¹´ì¹´ì˜¤ë±…í¬ ì•±ì´ë‚˜ í† ìŠ¤ì—ì„œ\nì‰½ê²Œ í™•ì¸ ê°€ëŠ¥í•´ìš”!', type: 'number', placeholder: 'ì˜ˆ: 750', section: 'ì‹ ìš© ì •ë³´' },
        { key: 'NICE', text: 'NICE ì‹ ìš©ì ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\n\nğŸ’¡ ëª¨ë¥´ì‹œë©´ ì¹´ì¹´ì˜¤ë±…í¬ ì•±ì´ë‚˜ í† ìŠ¤ì—ì„œ\nì‰½ê²Œ í™•ì¸ ê°€ëŠ¥í•´ìš”!', type: 'number', placeholder: 'ì˜ˆ: 800', section: 'ì‹ ìš© ì •ë³´' },
        { key: 'overdue', text: 'í˜„ì¬ ì—°ì²´ ë˜ëŠ” ì²´ë‚©ì´ ìˆìœ¼ì‹ ê°€ìš”?\n\nâš ï¸ ì—°ì²´ ì‹œ ì •ì±…ìê¸ˆ ì´ìš©ì´ ë¶ˆê°€í•©ë‹ˆë‹¤', type: 'choice', options: ['ì—†ìŒ', 'ìˆìŒ'], section: 'ì‹ ìš© ì •ë³´' }
      ];

      return [...base, ...industrySpecific, ...remaining];
    }

    // ============ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ============
    function getTime() {
      const now = new Date();
      return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
    }

    function formatMoney(num) {
      if (num >= 10000) {
        const ì–µ = Math.floor(num / 10000);
        const ë§Œ = num % 10000;
        return ë§Œ > 0 ? `${ì–µ}ì–µ ${ë§Œ.toLocaleString()}ë§Œì›` : `${ì–µ}ì–µì›`;
      }
      return `${num.toLocaleString()}ë§Œì›`;
    }

    function formatNumberInput(value) {
      const num = value.replace(/[^0-9]/g, '');
      return num ? parseInt(num).toLocaleString() : '';
    }

    function scrollToBottom() {
      const chatMessages = document.getElementById('chatMessages');
      setTimeout(() => { chatMessages.scrollTop = chatMessages.scrollHeight; }, 100);
    }

    function updateProgress() {
      const progress = Math.min((currentStep / (questions.length - 1)) * 100, 100);
      document.getElementById('progressFill').style.width = `${progress}%`;
      document.getElementById('progressText').textContent = `${Math.round(progress)}%`;
      if (currentStep > 0) document.getElementById('headerProgress').classList.add('active');
    }

    // ============ ë©”ì‹œì§€ ë Œë”ë§ ============
    function addBotMessage(question, showSection = true) {
      const chatMessages = document.getElementById('chatMessages');
      const prevSection = chatMessages.lastElementChild?.dataset?.section;
      
      const wrapper = document.createElement('div');
      wrapper.className = 'message-wrapper bot';
      wrapper.dataset.section = question.section;

      let sectionBadge = '';
      if (showSection && question.section && question.section !== 'intro' && question.section !== 'loading' && prevSection !== question.section) {
        sectionBadge = `<div class="section-badge">${question.section}</div>`;
      }

      let iconHtml = question.icon ? `<div class="message-icon">${question.icon}</div>` : '';
      let buttonsHtml = '';

      if (question.type === 'button' && question.options) {
        buttonsHtml = `<button class="start-btn" onclick="handleSubmit('${question.options[0]}')">${question.options[0]}<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7" /></svg></button>`;
      } else if (question.type === 'choice' && question.options) {
        buttonsHtml = `<div class="choice-buttons">${question.options.map(opt => `<button class="choice-btn" onclick="handleSubmit('${opt}')">${opt}</button>`).join('')}</div>`;
      }
      
      // ë¶„ì„í•˜ê¸° ë²„íŠ¼ ì¶”ê°€
      if (question.showAnalysisBtn) {
        buttonsHtml = `<button class="analysis-btn" onclick="openAnalysisModal()">
          <span>ğŸ“Š ë‚´ ì—…ì¥ì— ë§ëŠ” ì •ì±…ìê¸ˆ ë¶„ì„í•˜ê¸°</span>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </button>`;
      }

      wrapper.innerHTML = `
        <div class="bot-avatar">ğŸ¤–</div>
        <div class="message-content">
          ${sectionBadge}
          <div class="message-bubble bot">
            ${iconHtml}
            <div class="message-text">${question.text}</div>
            ${buttonsHtml}
          </div>
          <span class="message-time">${getTime()}</span>
        </div>
      `;

      chatMessages.appendChild(wrapper);
      scrollToBottom();

      const chatInput = document.getElementById('chatInput');
      const userInput = document.getElementById('userInput');
      
      if (question.type === 'text' || question.type === 'number') {
        chatInput.classList.add('active');
        userInput.placeholder = question.placeholder || 'ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”';
        userInput.dataset.type = question.type;
        userInput.value = '';
        userInput.focus();
      } else {
        chatInput.classList.remove('active');
      }
    }

    function addUserMessage(text) {
      const chatMessages = document.getElementById('chatMessages');
      const wrapper = document.createElement('div');
      wrapper.className = 'message-wrapper user';
      wrapper.innerHTML = `<div class="message-content"><div class="message-bubble user"><div class="message-text">${text}</div></div><span class="message-time">${getTime()}</span></div>`;
      chatMessages.appendChild(wrapper);
      scrollToBottom();
    }

    function showTyping() {
      const chatMessages = document.getElementById('chatMessages');
      const wrapper = document.createElement('div');
      wrapper.className = 'message-wrapper bot';
      wrapper.id = 'typingIndicator';
      wrapper.innerHTML = `<div class="bot-avatar">ğŸ¤–</div><div class="message-content"><div class="message-bubble bot"><div class="typing-dots"><span></span><span></span><span></span></div></div></div>`;
      chatMessages.appendChild(wrapper);
      scrollToBottom();
    }

    function hideTyping() {
      const typing = document.getElementById('typingIndicator');
      if (typing) typing.remove();
    }

    // ============ ì œì¶œ ì²˜ë¦¬ ============
    function handleSubmit(value) {
      if (currentStep >= questions.length) return;
      
      const question = questions[currentStep];
      let displayValue = value;
      let dataValue = value;

      if (question.key === 'start') {
        addUserMessage('ì‹œì‘í• ê²Œìš” âœ¨');
        currentStep++;
        updateProgress();
        showTyping();
        setTimeout(() => { hideTyping(); addBotMessage(questions[currentStep]); }, 600);
        return;
      }

      if (question.type === 'number') {
        const num = parseInt(value.toString().replace(/,/g, ''));
        if (isNaN(num) || num < 0) {
          showTyping();
          setTimeout(() => { hideTyping(); addBotMessage({ text: 'ìˆ«ìë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš” ğŸ˜Š', section: 'error' }, false); }, 400);
          return;
        }
        dataValue = num;
        if (['average_sales', 'credit_loan', 'mortgage_loan'].includes(question.key)) displayValue = formatMoney(num);
        else if (['NICE', 'KCB'].includes(question.key)) displayValue = `${num}ì `;
        else if (question.key === 'patent_count') displayValue = `${num}ê±´`;
      }

      if (question.type === 'text' && !value.trim()) {
        showTyping();
        setTimeout(() => { hideTyping(); addBotMessage({ text: 'ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš” ğŸ˜Š', section: 'error' }, false); }, 400);
        return;
      }

      disableCurrentChoices();
      addUserMessage(displayValue);
      userData[question.key] = dataValue;

      if (question.key === 'industry') questions = getQuestions(value);

      currentStep++;
      updateProgress();

      if (currentStep < questions.length) {
        showTyping();
        setTimeout(() => { hideTyping(); addBotMessage(questions[currentStep]); }, 600);
      } else {
        showTyping();
        setTimeout(() => {
          hideTyping();
          // ë¶„ì„ ì „ ì‹ ì²­ ë²„íŠ¼ í‘œì‹œ
          addBotMessage({ 
            text: 'ì…ë ¥í•´ì£¼ì‹  ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ\n<strong>ë§ì¶¤ ì •ì±…ìê¸ˆ ë¶„ì„</strong>ì„ ì§„í–‰í•´ë“œë¦½ë‹ˆë‹¤! ğŸ¯\n\nì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”.', 
            section: 'ë¶„ì„ ì¤€ë¹„ ì™„ë£Œ',
            showAnalysisBtn: true 
          }, false);
          document.getElementById('chatInput').classList.remove('active');
          document.getElementById('headerProgress').classList.remove('active');
        }, 600);
      }

      document.getElementById('userInput').value = '';
      document.getElementById('sendBtn').disabled = true;
    }

    function disableCurrentChoices() {
      const chatMessages = document.getElementById('chatMessages');
      const lastBotMessage = chatMessages.querySelector('.message-wrapper.bot:last-of-type');
      if (lastBotMessage) {
        const buttons = lastBotMessage.querySelectorAll('.choice-btn, .start-btn');
        buttons.forEach(btn => { btn.disabled = true; btn.style.opacity = '0.5'; btn.style.cursor = 'default'; btn.onclick = null; });
      }
    }

    // ============ ê³ ê¸‰ ê³„ì‚° ë¡œì§ ============
    
    // ê¸ˆë¦¬ ê³„ì‚° (NICE ì ìˆ˜ ê¸°ë°˜)
    function calculateRate(nice) {
      if (nice <= 650) return 4.3;
      if (nice >= 850) return 3.1;
      return parseFloat((4.3 - ((nice - 650) / 200) * 1.2).toFixed(2));
    }

    // ìŠ¹ì¸ í™•ë¥  ê³„ì‚°
    function calculateProbability(data) {
      const { average_sales, credit_loan, mortgage_loan, NICE, KCB, overdue, business_career } = data;
      
      if (overdue === 'ìˆìŒ') return 0;
      
      let score = 93;
      
      // ë§¤ì¶œ ëŒ€ë¹„ ë¶€ì±„ ë¹„ìœ¨
      const totalDebt = credit_loan + mortgage_loan;
      const debtRatio = average_sales > 0 ? totalDebt / average_sales : 1;
      score -= debtRatio * 25;
      
      // ë§¤ì¶œ ê·œëª¨ ë³´ë„ˆìŠ¤
      if (average_sales > 0) score += Math.log10(average_sales) * 2;
      
      // ì‹ ìš© ì ìˆ˜ ë°˜ì˜
      const avgCredit = (NICE + KCB) / 2;
      if (avgCredit >= 800) score += 5;
      else if (avgCredit < 700) score -= 10;
      
      // ì—…ë ¥ ë°˜ì˜
      if (business_career === '1ë…„ ë¯¸ë§Œ') score -= 5;
      else if (business_career === '7ë…„ ì´ìƒ' && debtRatio > 1) score -= 15;
      
      return Math.max(10, Math.min(95, Math.round(score)));
    }

    // ì¡°ê±´ ë¶„ì„
    function getConditions(data) {
      const expectLoan = ['7ë…„ ì´ìƒ'].includes(data.business_career)
        ? data.credit_loan + data.mortgage_loan
        : data.credit_loan;

      const unavailable = data.overdue === 'ìˆìŒ' ||
        (['7ë…„ ì´ìƒ'].includes(data.business_career) && expectLoan > data.average_sales * 1.5);

      const isHighCredit = data.NICE >= 750 && data.KCB >= 700;
      const isSmart = [data.kiosk, data.delivery, data.reservation, data.online_sales].includes('ì‚¬ìš©í•¨') || data.online_sales === 'ì˜ˆ';
      const isGrowth = data.sales_growth === 'ì˜ˆ';
      const hasTech = data.patent_count > 0;
      const hasMachine = data.has_machine === 'ë³´ìœ í•¨';

      let salesLevel;
      if (data.average_sales < 2000) salesLevel = 'low';
      else if (data.average_sales < 8000) salesLevel = 'mid';
      else salesLevel = 'high';

      return { unavailable, isHighCredit, isSmart, isGrowth, hasTech, hasMachine, salesLevel, expectLoan };
    }

    // í•œë„ ê³„ì‚°
    function calculateLimit(data) {
      const conditions = getConditions(data);
      if (conditions.unavailable) return 0;

      let rate = 0.25; // ê¸°ë³¸

      // ìŠ¤ë§ˆíŠ¸ìƒì  ìš°ëŒ€
      if (conditions.isSmart && conditions.isHighCredit) rate = 0.6;
      else if (conditions.isSmart) rate = 0.4;
      // ë§¤ì¶œ ê·œëª¨ë³„
      else if (conditions.salesLevel === 'low') rate = conditions.isHighCredit ? 0.3 : 0.25;
      else if (conditions.salesLevel === 'mid') rate = conditions.isHighCredit ? 0.5 : 0.35;
      else rate = conditions.isHighCredit ? 0.45 : 0.3;

      // ìš°ëŒ€ ê°€ì‚°
      if (conditions.hasTech) rate += 0.1;
      if (conditions.isGrowth) rate += 0.05;
      if (conditions.hasMachine) rate += 0.05;

      return Math.floor(data.average_sales * rate);
    }

    // ì¶”ì²œ ìƒí’ˆ ì„ ì • (ì†Œìƒê³µì¸/ì¤‘ì†Œê¸°ì—… ë¶„ë¥˜)
    function getRecommendedProducts(data) {
      const conditions = getConditions(data);
      const products = [];
      const limit = calculateLimit(data);
      const isSmall = isSmallBusiness(data);
      
      // ê¸°ì—… ìœ í˜• ì €ì¥
      data.businessCategory = isSmall ? 'ì†Œìƒê³µì¸' : 'ì¤‘ì†Œê¸°ì—…';

      if (isSmall) {
        // ============ ì†Œìƒê³µì¸ ì¶”ì²œ ============
        
        // ì €ì‹ ìš©ì (NCB 839ì  ì´í•˜)
        if (data.NICE <= 839) {
          products.push({
            ...smallBizFunds.low_credit,
            estimatedLimit: 3000,
            estimatedRate: smallBizFunds.low_credit.minRate
          });
          // ë¯¸ì†Œê¸ˆìœµë„ ì¶”ì²œ
          if (data.NICE <= 749) {
            products.push({
              ...smallBizFunds.miso_finance,
              estimatedLimit: 7000,
              estimatedRate: smallBizFunds.miso_finance.minRate
            });
          }
        }

        // ìŠ¤ë§ˆíŠ¸ ì†Œìƒê³µì¸ (ë°°ë‹¬ì•±, í‚¤ì˜¤ìŠ¤í¬ ë“±)
        if (conditions.isSmart) {
          products.push({
            ...smallBizFunds.innovation_growth,
            estimatedLimit: Math.min(limit * 1.5, 20000),
            estimatedRate: smallBizFunds.innovation_growth.minRate
          });
        }

        // ì²­ë…„ ì†Œìƒê³µì¸ (ì—…ë ¥ 3ë…„ ë¯¸ë§Œ)
        if (['1ë…„ ë¯¸ë§Œ', '3ë…„ ë¯¸ë§Œ'].includes(data.business_career)) {
          products.push({
            ...smallBizFunds.youth_employ,
            estimatedLimit: Math.min(limit, 7000),
            estimatedRate: smallBizFunds.youth_employ.minRate
          });
        }

        // ì œì¡°ì—… ì†Œê³µì¸
        if (data.industry === 'ì œì¡°ì—…') {
          products.push({
            ...smallBizFunds.small_manufacturer,
            estimatedLimit: Math.min(limit * 2, 50000),
            estimatedRate: smallBizFunds.small_manufacturer.minRate
          });
        }

        // ë§¤ì¶œ ì„±ì¥ ì†Œìƒê³µì¸
        if (conditions.isGrowth) {
          products.push({
            ...smallBizFunds.innovation_growth,
            estimatedLimit: Math.min(limit * 1.3, 20000),
            estimatedRate: smallBizFunds.innovation_growth.minRate - 0.2
          });
        }

        // ê¸°ë³¸: ì¼ë°˜ê²½ì˜ì•ˆì •ìê¸ˆ (ëª¨ë“  ì†Œìƒê³µì¸)
        products.push({
          ...smallBizFunds.general_stable,
          estimatedLimit: Math.min(limit, 7000),
          estimatedRate: smallBizFunds.general_stable.minRate
        });

        // ì§€ì—­ì‹ ë³´ ë³´ì¦ ì¶”ì²œ
        if (data.NICE >= 700) {
          products.push({
            ...smallBizFunds.local_guarantee,
            estimatedLimit: Math.min(limit * 1.5, 30000),
            estimatedRate: smallBizFunds.local_guarantee.minRate
          });
        }

      } else {
        // ============ ì¤‘ì†Œê¸°ì—… ì¶”ì²œ ============

        // íŠ¹í—ˆ/ê¸°ìˆ  ë³´ìœ  ê¸°ì—…
        if (conditions.hasTech) {
          products.push({
            ...smeFunds.tech_commercialize,
            estimatedLimit: Math.min(limit * 3, 300000),
            estimatedRate: smeFunds.tech_commercialize.minRate
          });
          // ê¸°ìˆ ë³´ì¦ê¸°ê¸ˆë„ ì¶”ì²œ
          products.push({
            ...smeFunds.kibo_tech,
            estimatedLimit: Math.min(limit * 2, 100000),
            estimatedRate: smeFunds.kibo_tech.minRate
          });
        }

        // ì—…ë ¥ 7ë…„ ë¯¸ë§Œ ì°½ì—…ê¸°ì—…
        if (['1ë…„ ë¯¸ë§Œ', '3ë…„ ë¯¸ë§Œ', '5ë…„ ë¯¸ë§Œ', '7ë…„ ë¯¸ë§Œ'].includes(data.business_career)) {
          products.push({
            ...smeFunds.startup_base,
            estimatedLimit: Math.min(limit * 2, 60000),
            estimatedRate: smeFunds.startup_base.minRate
          });
          // ì²­ë…„ ì°½ì—…ì
          if (['1ë…„ ë¯¸ë§Œ', '3ë…„ ë¯¸ë§Œ'].includes(data.business_career)) {
            products.push({
              ...smeFunds.youth_startup,
              estimatedLimit: Math.min(limit, 20000),
              estimatedRate: smeFunds.youth_startup.minRate
            });
          }
          // ì°½ì—…ê¸°ì—…ìœ¡ì„± ë³´ì¦
          products.push({
            ...smeFunds.startup_nest,
            estimatedLimit: Math.min(limit * 1.5, 50000),
            estimatedRate: smeFunds.startup_nest.minRate
          });
        }

        // ìŠ¤ë§ˆíŠ¸ê³µì¥ ë„ì… ê¸°ì—…
        if (conditions.hasMachine || data.industry === 'ì œì¡°ì—…') {
          products.push({
            ...smeFunds.smart_factory,
            estimatedLimit: Math.min(limit * 3, 100000),
            estimatedRate: smeFunds.smart_factory.minRate
          });
        }

        // ìˆ˜ì¶œ ê¸°ì—…
        if (conditions.isGrowth && data.average_sales >= 50000) {
          products.push({
            ...smeFunds.export_global,
            estimatedLimit: Math.min(limit * 2, 100000),
            estimatedRate: smeFunds.export_global.minRate
          });
        } else {
          products.push({
            ...smeFunds.export_domestic,
            estimatedLimit: Math.min(limit, 50000),
            estimatedRate: smeFunds.export_domestic.minRate
          });
        }

        // ì—…ë ¥ 7ë…„ ì´ìƒ ì„±ì¥ê¸°ì—…
        if (data.business_career === '7ë…„ ì´ìƒ' && conditions.isGrowth) {
          products.push({
            ...smeFunds.innovation_growth_sme,
            estimatedLimit: Math.min(limit * 3, 100000),
            estimatedRate: smeFunds.innovation_growth_sme.minRate
          });
        }

        // ê¸°ë³¸: ì‹ ìš©ë³´ì¦ê¸°ê¸ˆ ë³´ì¦
        products.push({
          ...smeFunds.kodit_general,
          estimatedLimit: Math.min(limit * 2, 80000),
          estimatedRate: smeFunds.kodit_general.minRate
        });
      }

      // ì¤‘ë³µ ì œê±° ë° ìƒìœ„ 5ê°œë§Œ ë°˜í™˜
      const uniqueProducts = products.filter((p, i, arr) => 
        arr.findIndex(x => x.name === p.name) === i
      ).slice(0, 5);

      return uniqueProducts;
    }

    function formatLimit(val) {
      if (val === 0) return 'ì§„í–‰ ë¶ˆê°€';
      if (val >= 100000) {
        const ì–µ = Math.floor(val / 10000);
        return `${ì–µ}ì–µì›`;
      }
      if (val >= 10000) {
        const ì–µ = Math.floor(val / 10000);
        const ë§Œ = val % 10000;
        return ë§Œ > 0 ? `${ì–µ}ì–µ ${ë§Œ.toLocaleString()}ë§Œì›` : `${ì–µ}ì–µì›`;
      }
      return `${val.toLocaleString()}ë§Œì›`;
    }

    // ============ ìƒí™˜ ê³„ì‚°ê¸° ============
    function toggleCalculator() {
      const body = document.getElementById('calcBody');
      const arrow = document.getElementById('calcArrow');
      body.classList.toggle('open');
      arrow.classList.toggle('open');
    }

    function calculateSchedule() {
      const amount = parseInt(document.getElementById('calcAmount').value.replace(/,/g, '')) || 0;
      const rate = parseFloat(document.getElementById('calcRate').value) || 0;
      const grace = parseInt(document.getElementById('calcGrace').value) || 0;
      const period = parseInt(document.getElementById('calcPeriod').value) || 0;
      const method = document.getElementById('calcMethod').value;

      if (amount <= 0 || rate <= 0 || period <= 0) {
        alert('ì˜¬ë°”ë¥¸ ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      const monthlyRate = rate / 100 / 12;
      const totalMonths = period * 12;
      const graceMonths = grace * 12;
      const repayMonths = totalMonths - graceMonths;

      let schedule = [];
      let totalInterest = 0;
      let totalPayment = 0;
      let balance = amount;

      // ê±°ì¹˜ê¸°ê°„
      for (let i = 1; i <= graceMonths; i++) {
        const interest = Math.round(balance * monthlyRate);
        totalInterest += interest;
        totalPayment += interest;
        schedule.push({
          month: i,
          principal: 0,
          interest: interest,
          payment: interest,
          balance: balance
        });
      }

      // ìƒí™˜ê¸°ê°„
      if (method === 'equal_principal_interest') {
        // ì›ë¦¬ê¸ˆê· ë“±
        const monthlyPayment = Math.round(amount * monthlyRate * Math.pow(1 + monthlyRate, repayMonths) / (Math.pow(1 + monthlyRate, repayMonths) - 1));
        
        for (let i = graceMonths + 1; i <= totalMonths; i++) {
          const interest = Math.round(balance * monthlyRate);
          const principal = monthlyPayment - interest;
          balance = Math.max(0, balance - principal);
          totalInterest += interest;
          totalPayment += monthlyPayment;
          schedule.push({
            month: i,
            principal: principal,
            interest: interest,
            payment: monthlyPayment,
            balance: Math.round(balance)
          });
        }
      } else {
        // ì›ê¸ˆê· ë“±
        const monthlyPrincipal = Math.round(amount / repayMonths);
        
        for (let i = graceMonths + 1; i <= totalMonths; i++) {
          const interest = Math.round(balance * monthlyRate);
          const principal = i === totalMonths ? balance : monthlyPrincipal;
          balance = Math.max(0, balance - principal);
          const payment = principal + interest;
          totalInterest += interest;
          totalPayment += payment;
          schedule.push({
            month: i,
            principal: principal,
            interest: interest,
            payment: payment,
            balance: Math.round(balance)
          });
        }
      }

      // ê²°ê³¼ í‘œì‹œ
      const resultDiv = document.getElementById('calcResult');
      resultDiv.classList.add('show');

      document.getElementById('totalInterest').textContent = formatMoney(totalInterest);
      document.getElementById('totalPayment').textContent = formatMoney(totalPayment);
      document.getElementById('monthlyAvg').textContent = formatMoney(Math.round(totalPayment / totalMonths));

      // ìŠ¤ì¼€ì¤„ í…Œì´ë¸”
      const tableBody = document.getElementById('scheduleBody');
      tableBody.innerHTML = schedule.map(s => `
        <tr>
          <td>${s.month}íšŒì°¨</td>
          <td>${s.principal.toLocaleString()}</td>
          <td>${s.interest.toLocaleString()}</td>
          <td style="font-weight:600;">${s.payment.toLocaleString()}</td>
          <td>${s.balance.toLocaleString()}</td>
        </tr>
      `).join('');
    }

    // ============ ê²°ê³¼ í‘œì‹œ ============
    function showResult() {
      const conditions = getConditions(userData);
      const limit = calculateLimit(userData);
      const rate = calculateRate(userData.NICE);
      const probability = calculateProbability(userData);
      const recommendedProducts = getRecommendedProducts(userData);
      const circumference = 2 * Math.PI * 54;
      const strokeDasharray = `${(probability / 100) * circumference} ${circumference}`;

      // ë¶„ì„ ê²°ê³¼ë¥¼ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
      const bizCategory = userData.businessCategory || 'ì†Œìƒê³µì¸';
      analysisResult = {
        limit: limit,
        rate: rate,
        probability: probability,
        products: recommendedProducts,
        bizCategory: bizCategory
      };

      const chatMessages = document.getElementById('chatMessages');
      const resultCard = document.createElement('div');
      resultCard.className = 'result-card';

      if (conditions.unavailable) {
        resultCard.innerHTML = `
          <div class="result-header">
            <div class="result-badge" style="background:linear-gradient(135deg,#ef4444,#f87171);">ë¶„ì„ ì™„ë£Œ</div>
            <h2>'${userData.company}'</h2>
            <p>ì •ì±…ìê¸ˆ ì¡°ë‹¬ ê°€ëŠ¥ì„± ë¶„ì„ ê²°ê³¼</p>
          </div>
          <div class="result-unavailable">
            <div class="unavailable-icon">ğŸ˜”</div>
            <h3>í˜„ì¬ ì§„í–‰ì´ ì–´ë µìŠµë‹ˆë‹¤</h3>
            <p>${userData.overdue === 'ìˆìŒ' ? 'ì—°ì²´/ì²´ë‚© í•´ì†Œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\n\nì •ì±…ìê¸ˆì€ ì—°ì²´ ì´ë ¥ì´ ìˆìœ¼ë©´ ì´ìš©ì´ ë¶ˆê°€í•©ë‹ˆë‹¤.' : 'ëŒ€ì¶œ ê·œëª¨ê°€ ë§¤ì¶œ ëŒ€ë¹„ ë†’ìŠµë‹ˆë‹¤.\n\nê¸°ì¡´ ë¶€ì±„ë¥¼ ì¼ë¶€ ìƒí™˜ í›„ ì¬ì‹ ì²­ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.'}</p>
          </div>
          <div class="result-notice">
            ğŸ’¡ <strong>Tip:</strong> ì—°ì²´ í•´ì†Œ ë˜ëŠ” ë¶€ì±„ ì •ë¦¬ í›„ ì¬ì§„ë‹¨ ë°›ìœ¼ì‹œë©´<br>ì •ì±…ìê¸ˆ ì´ìš©ì´ ê°€ëŠ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          </div>
          <button class="restart-btn" onclick="resetChat()">
            <span>ë‹¤ì‹œ ë¶„ì„í•˜ê¸°</span>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15" />
            </svg>
          </button>
        `;
      } else {
        // ì¸ì‚¬ì´íŠ¸ ìƒì„±
        let insights = [];
        
        // ê¸°ì—… ë¶„ë¥˜ ì¸ì‚¬ì´íŠ¸ (ë§¨ ì•ì— ì¶”ê°€)
        const bizCategory = userData.businessCategory || 'ì†Œìƒê³µì¸';
        if (bizCategory === 'ì†Œìƒê³µì¸') {
          insights.push({ icon: 'ğŸª', text: `ì†Œìƒê³µì¸ ë¶„ë¥˜ - ì†Œì§„ê³µ/ì§€ì—­ì‹ ë³´/ì„œë¯¼ê¸ˆìœµ ìê¸ˆ ëŒ€ìƒ`, type: 'positive' });
        } else {
          insights.push({ icon: 'ğŸ¢', text: `ì¤‘ì†Œê¸°ì—… ë¶„ë¥˜ - ì¤‘ì§„ê³µ/ì‹ ë³´/ê¸°ë³´ ìê¸ˆ ëŒ€ìƒ`, type: 'positive' });
        }
        
        if (conditions.isHighCredit) insights.push({ icon: 'âœ…', text: 'ì‹ ìš©ë“±ê¸‰ ìš°ìˆ˜ - ìµœì €ê¸ˆë¦¬ ì ìš© ê°€ëŠ¥', type: 'positive' });
        else insights.push({ icon: 'ğŸ’¡', text: 'ì‹ ìš©ì ìˆ˜ ê°œì„  ì‹œ ê¸ˆë¦¬ ìš°ëŒ€ ê°€ëŠ¥', type: 'warning' });
        
        if (conditions.salesLevel === 'high') insights.push({ icon: 'âœ…', text: 'ë§¤ì¶œê·œëª¨ ì–‘í˜¸ - ê³ í•œë„ ì´ìš© ê°€ëŠ¥', type: 'positive' });
        else if (conditions.salesLevel === 'mid') insights.push({ icon: 'ğŸ“ˆ', text: 'ì„±ì¥ë‹¨ê³„ ê¸°ì—… - ì„±ì¥ì§€ì›ìê¸ˆ ì¶”ì²œ', type: '' });
        else insights.push({ icon: 'ğŸ’¡', text: 'ì†Œê·œëª¨ ì‚¬ì—…ì - ê²½ì˜ì•ˆì •ìê¸ˆ ì¶”ì²œ', type: '' });

        if (conditions.hasTech) insights.push({ icon: 'ğŸ†', text: `íŠ¹í—ˆ ${userData.patent_count}ê±´ ë³´ìœ  - ê¸°ìˆ ì‚¬ì—…í™”ìê¸ˆ ìš°ëŒ€`, type: 'positive' });
        if (conditions.isGrowth) insights.push({ icon: 'ğŸš€', text: 'ë§¤ì¶œ ì„±ì¥ ê¸°ì—… - ê¸ˆë¦¬ 0.2%p ìš°ëŒ€ ì ìš©', type: 'positive' });
        if (conditions.isSmart) insights.push({ icon: 'ğŸ“±', text: 'ìŠ¤ë§ˆíŠ¸ìƒì  ì¸ì • - í•œë„ 60%ê¹Œì§€ í™•ëŒ€', type: 'positive' });
        if (conditions.hasMachine) insights.push({ icon: 'ğŸ­', text: 'ì„¤ë¹„ ë³´ìœ  - ì‹œì„¤ìê¸ˆ/ë‹´ë³´ëŒ€ì¶œ ê°€ëŠ¥', type: 'positive' });

        const insightsHtml = insights.map(i => `<div class="insight-item ${i.type}"><span class="insight-icon">${i.icon}</span><span>${i.text}</span></div>`).join('');

        // ê¸°ì—… ë¶„ë¥˜ í‘œì‹œ
        const categoryColor = bizCategory === 'ì†Œìƒê³µì¸' ? '#10b981' : '#6366f1';
        const categoryIcon = bizCategory === 'ì†Œìƒê³µì¸' ? 'ğŸª' : 'ğŸ¢';

        // ì¶”ì²œ ìƒí’ˆ HTML (ìƒˆë¡œìš´ ì–‘ì‹ + ì‹ ì²­í•˜ê¸° ë²„íŠ¼)
        const productsHtml = recommendedProducts.map((p, idx) => `
          <div class="recommend-item">
            <div class="recommend-item-header">
              <div class="recommend-item-number">${idx + 1}</div>
              <div class="recommend-item-title-wrap">
                <div class="recommend-item-title">${p.name}</div>
                <div class="recommend-item-org">${p.org}</div>
              </div>
            </div>
            <div class="recommend-item-body">
              <div class="recommend-info-row">
                <span class="recommend-info-label">ìê¸ˆëŒ€ìƒ</span>
                <span class="recommend-info-value">${p.target}</span>
              </div>
              <div class="recommend-info-row">
                <span class="recommend-info-label">ìµœëŒ€í•œë„</span>
                <span class="recommend-info-value highlight">${formatLimit(p.maxLimit)}</span>
              </div>
              <div class="recommend-info-row">
                <span class="recommend-info-label">ìµœì €ê¸ˆë¦¬</span>
                <span class="recommend-info-value">${p.minRate}%</span>
              </div>
              <div class="recommend-info-row">
                <span class="recommend-info-label">ìƒí™˜ê¸°ê°„</span>
                <span class="recommend-info-value">${p.period}</span>
              </div>
              <div class="recommend-estimate">
                <div class="recommend-estimate-row">
                  <span>ì˜ˆìƒ í•œë„: <strong>${formatLimit(p.estimatedLimit)}</strong></span>
                  <span>ì˜ˆìƒ ê¸ˆë¦¬: <strong>${p.estimatedRate.toFixed(2)}%</strong></span>
                </div>
                <button class="cta-item-btn" onclick='openModal("consultModal", ${JSON.stringify(p).replace(/'/g, "&#39;")})'>
                  ğŸ“ ë¬´ë£Œìë¬¸ìƒë‹´
                </button>
              </div>
            </div>
          </div>
        `).join('');

        resultCard.innerHTML = `
          <div class="result-header">
            <div class="result-badge">ë¶„ì„ ì™„ë£Œ</div>
            <h2>'${userData.company}'</h2>
            <p>ì •ì±…ìê¸ˆ ì¡°ë‹¬ ê°€ëŠ¥ì„± ë¶„ì„ ê²°ê³¼</p>
          </div>

          <!-- ê¸°ì—… ë¶„ë¥˜ ë°°ì§€ -->
          <div class="biz-category-badge" style="background: ${categoryColor};">
            <span class="biz-category-icon">${categoryIcon}</span>
            <span class="biz-category-text">${bizCategory} ì •ì±…ìê¸ˆ ì¶”ì²œ</span>
            <span class="biz-category-sub">${bizCategory === 'ì†Œìƒê³µì¸' ? '(ì†Œì§„ê³µÂ·ì§€ì—­ì‹ ë³´Â·ì„œë¯¼ê¸ˆìœµ)' : '(ì¤‘ì§„ê³µÂ·ì‹ ë³´Â·ê¸°ë³´)'}</span>
          </div>

          <!-- í†µê³„ ë°°ë„ˆ -->
          <div class="stats-banner">
            <div class="stats-banner-title">ğŸ“Š 2025ë…„ ì •ë¶€ ì •ì±…ê¸ˆìœµ í˜„í™©</div>
            <div class="stats-banner-items">
              <div class="stats-banner-item">
                <div class="stats-banner-value">26.5ì¡°</div>
                <div class="stats-banner-label">ì´ ì§€ì›ê·œëª¨</div>
              </div>
              <div class="stats-banner-item">
                <div class="stats-banner-value">2.98%</div>
                <div class="stats-banner-label">í‰ê·  ê¸ˆë¦¬</div>
              </div>
              <div class="stats-banner-item">
                <div class="stats-banner-value">${bizCategory === 'ì†Œìƒê³µì¸' ? '3.77ì¡°' : '4.5ì¡°'}</div>
                <div class="stats-banner-label">${bizCategory} ë°°ì •</div>
              </div>
            </div>
          </div>
          
          <div class="result-gauge">
            <svg viewBox="0 0 120 120">
              <circle cx="60" cy="60" r="54" class="gauge-bg" />
              <circle cx="60" cy="60" r="54" class="gauge-fill" style="stroke-dasharray: ${strokeDasharray}" />
            </svg>
            <div class="gauge-text">
              <span class="gauge-value">${probability}</span>
              <span class="gauge-unit">%</span>
            </div>
            <div class="gauge-label">${probability >= 80 ? 'ìŠ¹ì¸ ê°€ëŠ¥ì„± ë§¤ìš° ë†’ìŒ ğŸ‰' : probability >= 60 ? 'ìŠ¹ì¸ ê°€ëŠ¥ì„± ì–‘í˜¸ ğŸ‘' : 'ì¡°ê±´ ê°œì„  ê¶Œì¥ ğŸ“Š'}</div>
          </div>

          <!-- ë©”ì¸ CTA ë²„íŠ¼ -->
          <button class="cta-main-btn" onclick="openModal('consultModal')">
            âœ… ìŠ¹ì¸ê°€ëŠ¥ì—¬ë¶€ ì¡°íšŒ
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14M12 5l7 7-7 7"/>
            </svg>
          </button>

          <div class="result-stats">
            <div class="stat-card">
              <div class="stat-icon">ğŸ’°</div>
              <div class="stat-label">ì˜ˆìƒ ìµœëŒ€ í•œë„</div>
              <div class="stat-value">${formatLimit(limit)}</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">ğŸ“ˆ</div>
              <div class="stat-label">ì˜ˆìƒ ì ìš© ê¸ˆë¦¬</div>
              <div class="stat-value">${rate}%</div>
            </div>
          </div>

          <!-- ì¶”ì²œ ìƒí’ˆ -->
          <div class="recommend-section">
            <h4>ğŸ¯ ${bizCategory} ë§ì¶¤ ì¶”ì²œ ì •ì±…ìê¸ˆ</h4>
            <div class="recommend-list">
              ${productsHtml}
            </div>
          </div>

          <!-- ì¸ì‚¬ì´íŠ¸ -->
          <div class="result-insights">
            <h4>âœ¨ ë¶„ì„ ì¸ì‚¬ì´íŠ¸</h4>
            <div class="insight-list">${insightsHtml}</div>
          </div>

          <!-- ìƒí™˜ ê³„ì‚°ê¸° -->
          <div class="calculator-section">
            <div class="calculator-header" onclick="toggleCalculator()">
              <span>ğŸ§® ì´ì/ìƒí™˜ ìŠ¤ì¼€ì¤„ ê³„ì‚°ê¸°</span>
              <span class="calculator-arrow" id="calcArrow">â–¼</span>
            </div>
            <div class="calculator-body" id="calcBody">
              <div class="calc-row">
                <label class="calc-label">ëŒ€ì¶œ ê¸ˆì•¡ (ë§Œì›)</label>
                <input type="text" class="calc-input" id="calcAmount" value="${limit.toLocaleString()}" oninput="this.value=formatNumberInput(this.value)">
              </div>
              <div class="calc-row">
                <label class="calc-label">ì—° ê¸ˆë¦¬ (%)</label>
                <input type="number" step="0.1" class="calc-input" id="calcRate" value="${rate}">
              </div>
              <div class="calc-row-inline">
                <div class="calc-row">
                  <label class="calc-label">ê±°ì¹˜ ê¸°ê°„ (ë…„)</label>
                  <select class="calc-select" id="calcGrace">
                    <option value="0">ì—†ìŒ</option>
                    <option value="1">1ë…„</option>
                    <option value="2" selected>2ë…„</option>
                    <option value="3">3ë…„</option>
                  </select>
                </div>
                <div class="calc-row">
                  <label class="calc-label">ì´ ëŒ€ì¶œ ê¸°ê°„ (ë…„)</label>
                  <select class="calc-select" id="calcPeriod">
                    <option value="3">3ë…„</option>
                    <option value="5" selected>5ë…„</option>
                    <option value="7">7ë…„</option>
                    <option value="10">10ë…„</option>
                  </select>
                </div>
              </div>
              <div class="calc-row">
                <label class="calc-label">ìƒí™˜ ë°©ì‹</label>
                <select class="calc-select" id="calcMethod">
                  <option value="equal_principal_interest">ì›ë¦¬ê¸ˆê· ë“±ë¶„í• </option>
                  <option value="equal_principal">ì›ê¸ˆê· ë“±ë¶„í• </option>
                </select>
              </div>
              <button class="calc-btn" onclick="calculateSchedule()">ìƒí™˜ ìŠ¤ì¼€ì¤„ ê³„ì‚°</button>
              
              <div class="calc-result" id="calcResult">
                <div class="calc-result-summary">
                  <div class="calc-summary-item">
                    <div class="calc-summary-label">ì´ ì´ì</div>
                    <div class="calc-summary-value primary" id="totalInterest">-</div>
                  </div>
                  <div class="calc-summary-item">
                    <div class="calc-summary-label">ì´ ìƒí™˜ì•¡</div>
                    <div class="calc-summary-value" id="totalPayment">-</div>
                  </div>
                  <div class="calc-summary-item">
                    <div class="calc-summary-label">ì›” í‰ê·  ë‚©ë¶€ì•¡</div>
                    <div class="calc-summary-value primary" id="monthlyAvg">-</div>
                  </div>
                </div>
                <div class="schedule-table-wrapper">
                  <table class="schedule-table">
                    <thead>
                      <tr>
                        <th>íšŒì°¨</th>
                        <th>ì›ê¸ˆ</th>
                        <th>ì´ì</th>
                        <th>ë‚©ë¶€ì•¡</th>
                        <th>ì”ì•¡</th>
                      </tr>
                    </thead>
                    <tbody id="scheduleBody"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <!-- ìƒì„¸ì •ë³´ -->
          <details class="result-details">
            <summary>ğŸ“‹ ì…ë ¥ ì •ë³´ í™•ì¸</summary>
            <div class="details-grid">
              <div><span>ì‚¬ì—…ì¥</span><strong>${userData.company}</strong></div>
              <div><span>í˜•íƒœ</span><strong>${userData.business_type}</strong></div>
              <div><span>ì—…ì¢…</span><strong>${userData.industry}</strong></div>
              <div><span>ì—…ë ¥</span><strong>${userData.business_career}</strong></div>
              <div><span>ì—°ë§¤ì¶œ</span><strong>${formatMoney(userData.average_sales)}</strong></div>
              <div><span>ì‹ ìš©ëŒ€ì¶œ</span><strong>${formatMoney(userData.credit_loan)}</strong></div>
              <div><span>ë‹´ë³´ëŒ€ì¶œ</span><strong>${formatMoney(userData.mortgage_loan)}</strong></div>
              <div><span>ì‹ ìš©ì ìˆ˜</span><strong>NICE ${userData.NICE} / KCB ${userData.KCB}</strong></div>
            </div>
          </details>

          <div class="result-notice">
            â€» ë³¸ ê²°ê³¼ëŠ” ì…ë ¥ ì •ë³´ ê¸°ë°˜ ì˜ˆìƒì¹˜ì´ë©°, ì‹¤ì œ ì‹¬ì‚¬ ê²°ê³¼ì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
            â€» ì •í™•í•œ í•œë„/ê¸ˆë¦¬ëŠ” ì •ì±…ìê¸ˆ ì‹ ì²­ í›„ ì‹¬ì‚¬ë¥¼ í†µí•´ í™•ì •ë©ë‹ˆë‹¤.<br>
            â€» 2025ë…„ ì†Œìƒê³µì¸ ì •ì±…ìê¸ˆ ê¸°ì¤€ê¸ˆë¦¬: ì—° 2.98% (ë¶„ê¸°ë³„ ë³€ë™)
          </div>

          <button class="restart-btn" onclick="resetChat()">
            <span>ë‹¤ì‹œ ë¶„ì„í•˜ê¸°</span>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15" />
            </svg>
          </button>
        `;
      }

      chatMessages.appendChild(resultCard);
      scrollToBottom();
    }

    // ============ ì´ˆê¸°í™” ============
    function resetChat() {
      currentStep = 0;
      questions = getQuestions('');
      userData = {
        company: '', business_type: '', industry: '', business_career: '',
        patent_count: 0, has_machine: '', online_sales: '', offline_store: '',
        kiosk: '', delivery: '', reservation: '', average_sales: 0,
        sales_growth: '', mortgage_loan: 0, credit_loan: 0, KCB: 0, NICE: 0, overdue: ''
      };

      document.getElementById('chatMessages').innerHTML = '';
      document.getElementById('chatInput').classList.remove('active');
      document.getElementById('headerProgress').classList.remove('active');
      document.getElementById('progressFill').style.width = '0%';
      document.getElementById('progressText').textContent = '0%';
      document.getElementById('userInput').value = '';
      document.getElementById('sendBtn').disabled = true;

      setTimeout(() => addBotMessage(questions[0]), 300);
    }

    // ============ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ============
    document.addEventListener('DOMContentLoaded', function() {
      questions = getQuestions('');
      setTimeout(() => addBotMessage(questions[0]), 500);

      const userInput = document.getElementById('userInput');
      const sendBtn = document.getElementById('sendBtn');

      userInput.addEventListener('input', function(e) {
        const type = this.dataset.type;
        if (type === 'number') this.value = formatNumberInput(this.value);
        sendBtn.disabled = !this.value.trim();
      });

      userInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && this.value.trim()) handleSubmit(this.value.trim());
      });

      sendBtn.addEventListener('click', function() {
        const value = userInput.value.trim();
        if (value) handleSubmit(value);
      });
    });
  </script>
</body>
</html>
